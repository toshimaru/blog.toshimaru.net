<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.1">Jekyll</generator><link href="https://blog.toshimaru.net/feed/by_tag/api.xml" rel="self" type="application/atom+xml" /><link href="https://blog.toshimaru.net/" rel="alternate" type="text/html" /><updated>2023-01-21T02:29:31+09:00</updated><id>https://blog.toshimaru.net/feed/by_tag/api.xml</id><title type="html">Hack Your Design!</title><subtitle>toshimaruの技術系なブログ</subtitle><author><name>Toshimaru</name></author><entry><title type="html">コマンドラインで複数行を1行に連結する</title><link href="https://blog.toshimaru.net/join-lines-command/" rel="alternate" type="text/html" title="コマンドラインで複数行を1行に連結する" /><published>2015-09-30T00:00:00+09:00</published><updated>2019-11-02T00:00:00+09:00</updated><id>https://blog.toshimaru.net/join-lines-command</id><content type="html" xml:base="https://blog.toshimaru.net/join-lines-command/"><![CDATA[<p>やりたかったこととしては、コマンドラインで複数行の標準入力を受け取ってそれを１行にカンマ区切りにして出力すること。</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>text
<span class="go">aaaa
bbbb
cccc
</span></code></pre></div></div>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">cat </span>text | <span class="nb">tr</span> <span class="s1">'\n'</span> <span class="s1">','</span>
<span class="go">aaaa,bbbb,cccc,%
</span></code></pre></div></div>

<p>こんな感じで <code class="language-plaintext highlighter-rouge">tr</code> を使って改行コードを置換してやればカンマ区切りで1行に連結できる。</p>

<h2 id="jsonをパースして連結する">JSONをパースして連結する</h2>

<p>もともとやりたかったのはこんな感じのこと。</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span><span class="nb">echo</span> <span class="s1">'{ "employees":[{"firstName":"John", "lastName":"Doe"}, {"firstName":"Anna", "lastName":"Smith"}, {"firstName":"Peter","lastName":"Jones"} ] }'</span> | jq <span class="s1">'.employees[] .firstName'</span> | <span class="nb">tr</span> <span class="s1">'\n'</span> <span class="s1">','</span> | <span class="nb">awk</span> <span class="s1">'{ print "result = [" $1 "]" }'</span>
<span class="go">result = ["John","Anna","Peter",]
</span></code></pre></div></div>

<p>curlでJSONをHTTP GETしてそれを <code class="language-plaintext highlighter-rouge">jq</code> でパースして出たリストをカンマ区切りで出力する、みたいなやつ。</p>

<h2 id="参考">参考</h2>

<ul>
  <li><a href="http://stackoverflow.com/questions/2764051/how-to-join-multiple-lines-of-file-names-into-one-with-custom-delimiter">linux - How to join multiple lines of file names into one with custom delimiter? - Stack Overflow</a></li>
  <li><a href="http://tbpgr.hatenablog.com/entry/20120309/1331314857">tr | 標準入力の内容を置換、削除する - Tbpgr Blog</a></li>
</ul>]]></content><author><name>Toshimaru</name></author><category term="shell" /><category term="api" /><summary type="html"><![CDATA[やりたかったことは、コマンドラインで複数行の標準入力を受け取ってそれを１行にカンマ区切りにして出力すること。]]></summary></entry></feed>