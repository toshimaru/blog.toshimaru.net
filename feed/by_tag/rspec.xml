<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator><link href="https://blog.toshimaru.net/feed/by_tag/rspec.xml" rel="self" type="application/atom+xml" /><link href="https://blog.toshimaru.net/" rel="alternate" type="text/html" /><updated>2020-07-31T18:40:07+09:00</updated><id>https://blog.toshimaru.net/feed/by_tag/rspec.xml</id><title type="html">Hack Your Design!</title><subtitle>toshimaruã®æŠ€è¡“ç³»ãªãƒ–ãƒ­ã‚°</subtitle><author><name>Toshimaru</name></author><entry><title type="html">Rails on Docker ç’°å¢ƒã§ã® SystemSpec ç’°å¢ƒæ§‹ç¯‰</title><link href="https://blog.toshimaru.net/rails-on-docker-system-spec/" rel="alternate" type="text/html" title="Rails on Docker ç’°å¢ƒã§ã® SystemSpec ç’°å¢ƒæ§‹ç¯‰" /><published>2019-09-18T00:00:00+09:00</published><updated>2019-09-18T00:00:00+09:00</updated><id>https://blog.toshimaru.net/rails-on-docker-system-spec</id><content type="html" xml:base="https://blog.toshimaru.net/rails-on-docker-system-spec/">&lt;p&gt;Rails on Docker ãªç’°å¢ƒä¸Šã« SystemSpec(System Test + RSpec) ã‚’å°å…¥ã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h2 id=&quot;ç’°å¢ƒ&quot;&gt;ç’°å¢ƒ&lt;/h2&gt;

&lt;p&gt;ä»Šå›SystemSpecã‚’å°å…¥ã—ãŸã®ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªç’°å¢ƒã§ã™ã€‚&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: &lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/&quot;&gt;RailsTwitterClone&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;docker-compose&lt;/li&gt;
  &lt;li&gt;Ruby 2.6&lt;/li&gt;
  &lt;li&gt;chromium-driver&lt;/li&gt;
  &lt;li&gt;gem
    &lt;ul&gt;
      &lt;li&gt;rails (5.2)&lt;/li&gt;
      &lt;li&gt;rspec-rails&lt;/li&gt;
      &lt;li&gt;selenium-webdriver&lt;/li&gt;
      &lt;li&gt;capybara&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;å¯¾å¿œpull-request&quot;&gt;å¯¾å¿œPull Request&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/pull/506/files&quot;&gt;Re-try System Spec by toshimaru Â· Pull Request #506 Â· toshimaru/RailsTwitterClone&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;ç§ã®systemspecé…ã™ã&quot;&gt;ç§ã®SystemSpecã€é…ã™ãâ€¦ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;å®Ÿã¯ SystemSpec ã‚’å°å…¥ã—ã‚ˆã†ã¨è©¦ã¿ãŸã®ã¯ä»Šå›ã§äºŒå›ç›®ã§ã™ã€‚ä¸€å›ç›®ã¯ SystemTest ãŒ Rails ã®æ©Ÿèƒ½ã®ä¸€ã¤ã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦é–“ã‚‚ãªã„é ƒã«è©¦ã—ãŸã®ã§ã™ãŒã€ãƒ†ã‚¹ãƒˆå…¨ä½“ã«ã‹ã‹ã‚‹æ™‚é–“ãŒåŠ‡çš„ã«é…ããªã£ãŸãŸã‚ã€å°å…¥ã‚’æ–­å¿µã—ãŸã¨ã„ã†çµŒç·¯ãŒã‚ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;å½“æ™‚ã®Pull RequestãŒã“ã¡ã‚‰: &lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/pull/216&quot;&gt;Try System Spec by toshimaru Â· Pull Request #216 Â· toshimaru/RailsTwitterClone&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Before&lt;/p&gt;

  &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Finished in 15.74 seconds (files took 7.65 seconds to load)
152 examples, 0 failures
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;

  &lt;p&gt;After&lt;/p&gt;

  &lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Finished in 58.46 seconds (files took 7.64 seconds to load)
152 examples, 3 failures
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;  &lt;/div&gt;
&lt;/blockquote&gt;

&lt;p&gt;ã—ã‹ã—ã“ã‚Œã¯çµæœã‹ã‚‰ã„ã†ã¨è¨­å®šãŒæ‚ªã‹ã£ãŸã®ã§ã—ãŸã€‚ä¸‹è¨˜ã®ã‚ˆã†ã« system ãƒ†ã‚¹ãƒˆã‚’ Headless Chrome ã§èµ°ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã—ãŸãŒã€ã“ã‚Œã ã¨ã™ã¹ã¦ã® System ãƒ†ã‚¹ãƒˆãŒ Headless Chrome ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã¦ã—ã¾ã„ã€çµæœçš„ã«é…ããªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;before&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:each&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;type: :system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;driven_by&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:selenium_chrome_headless&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹è¨˜ã®ã‚ˆã†ã«JSã‚’èµ·å‹•ã•ã›ã‚‹å¿…è¦ã®ãªã„ System ãƒ†ã‚¹ãƒˆã¯å¾“æ¥é€šã‚Šã®&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rack_test&lt;/code&gt;ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;js: true&lt;/code&gt;ãªãƒ†ã‚¹ãƒˆã¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;selenium_chrome_headless&lt;/code&gt;ã«è¨­å®šã—ã¦ã‚„ã‚Œã°ãƒ†ã‚¹ãƒˆå…¨ä½“ãŒé«˜é€Ÿã«å®Ÿè¡Œå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;before&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:each&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;type: :system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;driven_by&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:rack_test&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;before&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:each&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;type: :system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;js: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;driven_by&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:selenium_chrome_headless&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;dockerfile&quot;&gt;Dockerfile&lt;/h2&gt;

&lt;p&gt;ä»Šå›åˆ©ç”¨ã—ãŸ &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Dockerfile&lt;/code&gt; ã¯ Ruby 2.6 ã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã« &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chromium-driver&lt;/code&gt; ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã¨ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-dockerfile highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt;&lt;span class=&quot;s&quot;&gt; ruby:2.6&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;RUN &lt;/span&gt;apt-get update &lt;span class=&quot;nt&quot;&gt;-qq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; apt-get &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; nodejs chromium-driver 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;chrome-failed-to-start-exited-abnormally&quot;&gt;Chrome failed to start: exited abnormally&lt;/h3&gt;

&lt;p&gt;ã—ã‹ã—ã€ä¸Šè¿°ã®ç’°å¢ƒã«ãŠã„ã¦&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec&lt;/code&gt;ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Failure/Error: Unable to infer file and line number from backtrace

  Selenium::WebDriver::Error::UnknownError:
      unknown error: Chrome failed to start: exited abnormally
      (unknown error: DevToolsActivePort file doesn't exist)
      (The process started from chrome location /usr/bin/chromium is no longer running, so ChromeDriver is assuming that Chrome has crashed.)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ Chrome ãŒ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sandbox&lt;/code&gt;ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã«èµ·å› ã—ã¾ã™ã€‚ä¸‹è¨˜ã®ã‚ˆã†ãª&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;no-sandbox&lt;/code&gt;ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã® Headless Chrome ã‚’ Capybara ã« driver ã¨ã—ã¦ç™»éŒ²ã—ã¦ã‚„ã‚‹ã“ã¨ã§å›é¿ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Capybara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;register_driver&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:headless_chrome&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;browser_options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Selenium&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;WebDriver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Chrome&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;tap&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--headless&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--disable-gpu&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;opts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;--no-sandbox&quot;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;Capybara&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Selenium&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Driver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;browser: :chrome&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;options: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;browser_options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã“ã†ã—ã¦ç™»éŒ²ã—ãŸ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;headless_chrome&lt;/code&gt;ã‚’SystemTestã«å¯¾ã—ã¦é©å¿œã•ã›ã¦ã‚„ã‚Œã°OKã§ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;RSpec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;before&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:each&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;type: :system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;js: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;driven_by&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:headless_chrome&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã“ã‚Œã§ãã¡ã‚“ã¨Dockerä¸Šã§SystemSpecãŒé€šã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;docker-compose run web rspec
&lt;span class=&quot;go&quot;&gt;
Randomized with seed 30150
............................................................................................................Capybara starting Puma...
* Version 4.1.1 , codename: Fourth and One
* Min threads: 0, max threads: 4
* Listening on tcp://127.0.0.1:38789
&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;...............................................
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;
Finished in 19.87 seconds (files took 8.8 seconds to load)
155 examples, 0 failures
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;å…¬å¼ã§ã¯no-sandboxã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ã¯ã—ã¦ãã‚Œãªã„&quot;&gt;å…¬å¼ã§ã¯no-sandboxã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ã¯ã—ã¦ãã‚Œãªã„ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;ä½™è«‡ã§ã™ãŒã€Capybaraæœ¬ä½“ã§ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;selenium_chrome_headless&lt;/code&gt;ã«&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;no-sandbox&lt;/code&gt;ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã™ã‚‹å¤‰æ›´ã‚’PRã—ã¦ã¿ã¾ã—ãŸãŒã€ä¸‹è¨˜ã®é€šã‚ŠRejectã•ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/teamcapybara/capybara/pull/2241&quot;&gt;Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;no-sandbox&lt;/code&gt; option for selenium_chrome_headless by toshimaru Â· Pull Request #2241 Â· teamcapybara/capybara&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;securityã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã®sandbox&quot;&gt;Securityã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã®sandbox&lt;/h3&gt;

&lt;p&gt;sandboxã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’é«˜ã‚ã‚‹ãŸã‚ã®ç’°å¢ƒãªã®ã§åŸºæœ¬çš„ã«ã¯ &lt;strong&gt;ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ no-sandbox ã«ã™ã‚‹ã¹ãã§ã¯ãªã„&lt;/strong&gt; ã¨ã„ã†åˆ¤æ–­ã®ã‚ˆã†ã§ã™ã€‚&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Sandbox leverages the OS-provided security to allow code execution that cannot make persistent changes to the computer or access information that is confidential.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;via. &lt;a href=&quot;https://chromium.googlesource.com/chromium/src/+/master/docs/design/sandbox.md&quot;&gt;Sandbox&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://qiita.com/ngron/items/f61b8635b4d67f666d75&quot;&gt;Rails + Selenium + Dockerã§SystemSpecã®ç’°å¢ƒæ§‹ç¯‰ - Qiita&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://news.mynavi.jp/article/20081009-a027/&quot;&gt;Google Chrome ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã§å®Ÿç¾ã™ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€Windowsã®æ©Ÿèƒ½ã«ä¾å­˜ | ãƒã‚¤ãƒŠãƒ“ãƒ‹ãƒ¥ãƒ¼ã‚¹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Toshimaru</name></author><category term="rspec" /><category term="rails" /><category term="docker" /><summary type="html">Rails on Docker ãªç’°å¢ƒä¸Šã« SystemSpec(System Test + RSpec) ã‚’å°å…¥ã—ã¾ã—ãŸã€‚</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.toshimaru.net/images/posts/systemspec/og.jpg" /><media:content medium="image" url="https://blog.toshimaru.net/images/posts/systemspec/og.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Rails E2Eãƒ†ã‚¹ãƒˆã§ poltergeist ã‹ã‚‰ Headless Chrome ã¸ã¨ä¹—ã‚Šæ›ãˆã‚‹</title><link href="https://blog.toshimaru.net/poltergeist-to-selenium-webdriver/" rel="alternate" type="text/html" title="Rails E2Eãƒ†ã‚¹ãƒˆã§ poltergeist ã‹ã‚‰ Headless Chrome ã¸ã¨ä¹—ã‚Šæ›ãˆã‚‹" /><published>2018-08-04T00:00:00+09:00</published><updated>2019-09-17T00:00:00+09:00</updated><id>https://blog.toshimaru.net/poltergeist-to-selenium-webdriver</id><content type="html" xml:base="https://blog.toshimaru.net/poltergeist-to-selenium-webdriver/">&lt;p&gt;Railsã®Capybaraã‚’ä½¿ã£ãŸE2Eãƒ†ã‚¹ãƒˆ(feature spec)ã‚’ã“ã®åº¦ã€&lt;a href=&quot;https://github.com/teampoltergeist/poltergeist&quot;&gt;poltergeist&lt;/a&gt;ã‹ã‚‰&lt;a href=&quot;https://chromium.googlesource.com/chromium/src/+/master/headless/README.md&quot;&gt;Headless Chrome&lt;/a&gt;ã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸã®ã§ãã®ã¨ãã®ãƒ¡ãƒ¢ã€‚&lt;/p&gt;

&lt;h2 id=&quot;å¯¾å¿œ-pull-request&quot;&gt;å¯¾å¿œ Pull Request&lt;/h2&gt;

&lt;p&gt;ä»Šå›å¯¾å¿œã—ãŸPull Requestã¯ã“ã¡ã‚‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/pull/211&quot;&gt;Use headless Chrome instead of PhantomJS(poltergeist) by toshimaru Â· Pull Request #211 Â· toshimaru/RailsTwitterClone Â· GitHub&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ€ã£ãŸã‚ˆã‚Šã‚‚å·®åˆ†ã¯ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«ã¾ã¨ã¾ã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h2 id=&quot;install-selenium-webdriver&quot;&gt;Install selenium-webdriver&lt;/h2&gt;

&lt;p&gt;ã¾ãšã¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;poltergeist&lt;/code&gt; gemã®ä»£ã‚ã‚Šã«ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;selenium-webdriver&lt;/code&gt;ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚&lt;/p&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gd&quot;&gt;-  gem &quot;poltergeist&quot;
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+  gem &quot;selenium-webdriver&quot;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;change-capybarajavascript_driver&quot;&gt;Change Capybara.javascript_driver&lt;/h2&gt;

&lt;p&gt;æ¬¡ã«&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Capybara.javascript_driver&lt;/code&gt;ã‚’&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;:poltergeist&lt;/code&gt;ã‹ã‚‰&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;:selenium_chrome_headless&lt;/code&gt;ã«å¤‰æ›´ã—ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gd&quot;&gt;- require &quot;capybara/poltergeist&quot;
- Capybara.javascript_driver = :poltergeist
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+ require &quot;selenium-webdriver&quot;
+ Capybara.javascript_driver = :selenium_chrome_headless
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã¡ãªã¿ã«&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;:selenium_chrome_headless&lt;/code&gt;ã®è¨­å®šã¯ä¸‹è¨˜ã®å¤‰æ›´ã®ä¸­ã§capybaraå†…ã«å–ã‚Šè¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Capybara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;register_driver&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:selenium_chrome_headless&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;browser_options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Selenium&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;WebDriver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Chrome&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;browser_options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'--headless'&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;browser_options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;args&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'--disable-gpu'&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;Capybara&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Selenium&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Driver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;browser: :chrome&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;options: &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;browser_options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;via. &lt;a href=&quot;https://github.com/teamcapybara/capybara/commit/0275eab42c610cd1ccde7947b051d0b00857b9ce&quot;&gt;add default selenium chrome driver registrations Â· teamcapybara/capybara@0275eab Â· GitHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;install-chromedriver&quot;&gt;Install chromedriver&lt;/h2&gt;

&lt;h3 id=&quot;on-macos&quot;&gt;On MacOS&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chromedriver&lt;/code&gt; ãŒå¿…è¦ã«ãªã£ã¦ãã‚‹ãŒã€Macã®å ´åˆã¯brewã§å…¥ã‚Œã¡ã‚ƒã†ã®ãŒä¸€ç•ªãƒ©ã‚¯ã§ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;brew cask &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;chromedriver
&lt;span class=&quot;go&quot;&gt;Updating Homebrew...
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;==&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;Auto-updated Homebrew!
&lt;span class=&quot;go&quot;&gt;Updated 1 tap (homebrew/cask).
No changes to formulae.

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;==&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;Satisfying dependencies
&lt;span class=&quot;gp&quot;&gt;==&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;Downloading https://chromedriver.storage.googleapis.com/2.41/chromedriver_mac64.zip
&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;####################################################################### 100.0%&lt;/span&gt;
&lt;span class=&quot;gp&quot;&gt;==&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;Verifying checksum &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Cask chromedriver
&lt;span class=&quot;gp&quot;&gt;==&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;Installing Cask chromedriver
&lt;span class=&quot;gp&quot;&gt;==&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;Extracting nested container chromedriver
&lt;span class=&quot;gp&quot;&gt;==&amp;gt;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;Linking Binary &lt;span class=&quot;s1&quot;&gt;'chromedriver'&lt;/span&gt; to &lt;span class=&quot;s1&quot;&gt;'/usr/local/bin/chromedriver'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;ğŸº  chromedriver was successfully installed!
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;æ³¨æ„äº‹é …&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew install chromedriver&lt;/code&gt;ã§ã¯installã§ããªã„ã®ã§æ³¨æ„ï¼ˆ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew cask&lt;/code&gt;çµŒç”±ã«ã™ã‚‹ã“ã¨ï¼‰&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chromedriver-helper&lt;/code&gt; gem ãŒå…¥ã£ã¦ã„ã‚‹ã¨ã†ã¾ãå‹•ã‹ãªã„å ´åˆãŒã‚ã‚‹ã®ã§æ³¨æ„&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;on-circleci&quot;&gt;On CircleCI&lt;/h3&gt;

&lt;p&gt;CircleCIä¸Šã§ã¯ã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ruby:x.x-node-browsers&lt;/code&gt;ã®CircleCIå…¬å¼Ruby Dokcer Imageã‚’ä½¿ã£ã¦ã„ã‚Œã°ãã¡ã‚“ã¨å‹•ä½œã—ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;na&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;circleci/ruby:2.5-node-browsers&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šè¨˜ã®è¨­å®šã®å ´åˆã€Ruby2.5ã®node-browsersãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;h3 id=&quot;on-travisci&quot;&gt;On TravisCI&lt;/h3&gt;

&lt;p&gt;ã“ã‚ŒãŒä»Šå›ã®å¯¾å¿œã§ä¸€ç•ªãƒãƒã£ãŸè¨­å®šã§ã—ãŸã€‚ã„ã‚ã„ã‚è©¦ã—ã¾ã—ãŸãŒä¸‹è¨˜ã®ã‚¨ãƒ©ãƒ¼ãŒãªã‹ãªã‹è§£æ±ºã§ãã¾ã›ã‚“ã§ã—ãŸã€‚&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Failures:

  1) Authentication authorization screenshot
     Failure/Error: before { visit signin_path }

     Selenium::WebDriver::Error::WebDriverError:
        Unable to find Mozilla geckodriver. Please download the server from https://github.com/mozilla/geckodriver/releases and place it somewhere on your PATH. More info at https://developer.mozilla.org/en-US/docs/Mozilla/QA/Marionette/WebDriver.
     # ./spec/features/authentication_pages_spec.rb:9:in `block (3 levels) in &amp;lt;top (required)&amp;gt;'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;del&gt;æœ¬å½“ã¯&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo: false&lt;/code&gt;ã®è¨­å®šã§å‹•ã‹ã—ãŸã‹ã£ãŸã®ã§ã™ãŒãã‚Œã ã¨ä¸Šæ‰‹ãã„ã‹ãªã‹ã£ãŸã®ã§&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo&lt;/code&gt;ã§èµ·å‹•ã•ã›ã¦&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chromium-chromedriver&lt;/code&gt;ã‚’ãƒ†ã‚¹ãƒˆå‰ã«Installã—ã¦ãƒ‘ã‚¹ã‚’é€šã™ã¨ã„ã†æ–¹æ³•ã§ãƒ†ã‚¹ãƒˆã‚’é€šã—ã¾ã—ãŸã€‚&lt;/del&gt;&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;required&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;language&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ruby&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;before_install&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;sudo apt-get install -y chromium-chromedriver&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;ln -s /usr/lib/chromium-browser/chromedriver ~/bin/chromedriver&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;del&gt;(ã‚‚ã†å°‘ã—ã‚¹ãƒãƒ¼ãƒˆãªã‚„ã‚Šæ–¹ã‚’ã”å­˜çŸ¥ã®æ–¹ã¯æ•™ãˆã¦ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ğŸ™)&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;è¿½è¨˜ï¼ˆ2019å¹´9æœˆ17æ—¥ï¼‰&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo&lt;/code&gt; ç„¡ã—ã§ã‚‚ä¸‹è¨˜ã®ã‚ˆã†ãªè¨­å®šã§ã„ã‘ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;dist&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bionic&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;addons&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;chrome&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;stable&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;apt&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;packages&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;chromium-chromedriver&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;å‚è€ƒPull Request: &lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/pull/524/files&quot;&gt;No sudo on TravisCI by toshimaru Â· Pull Request #524 Â· toshimaru/RailsTwitterClone&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;å‚è€ƒãƒªãƒ³ã‚¯&quot;&gt;å‚è€ƒãƒªãƒ³ã‚¯&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://ohbarye.hatenablog.jp/entry/2018/03/10/232300&quot;&gt;PhantomJS + Poltergeist ã‚’ Selenium + Headless Chrome ã§ç½®ãæ›ãˆã‚‹ (1) Rails + Capybara ã«ã‚ˆã‚‹ feature spec ç·¨ - valid,invalid&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://tech.speee.jp/entry/2017/06/15/135636&quot;&gt;RSpec ã® feature spec ã§ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ Chrome ã‚’ä½¿ã† - Speee DEVELOPER BLOG&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://y-yagi.tumblr.com/post/166831012790/rails%E9%9B%91%E3%81%ABsystem-test%E3%81%A7headless-chrome%E3%82%92%E4%BD%BF%E3%81%86&quot;&gt;[Rails]é›‘ã«System Testã§Headless Chromeã‚’ä½¿ã† | æ—¥ã€…é›‘è¨˜&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Toshimaru</name></author><category term="rails" /><category term="rspec" /><category term="chrome" /><summary type="html">Railsã®Capybaraã‚’ä½¿ã£ãŸE2Eãƒ†ã‚¹ãƒˆ(feature spec)ã‚’ã“ã®åº¦ã€poltergeistã‹ã‚‰Headless Chromeã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸã®ã§ãã®ã¨ãã®ãƒ¡ãƒ¢ã€‚</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.toshimaru.net/images/posts/chromedriver.jpg" /><media:content medium="image" url="https://blog.toshimaru.net/images/posts/chromedriver.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡è¨ˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹ã‚’Coverallsã‹ã‚‰CodeClimateã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸè©±</title><link href="https://blog.toshimaru.net/coverage-with-codeclimate/" rel="alternate" type="text/html" title="ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡è¨ˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹ã‚’Coverallsã‹ã‚‰CodeClimateã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸè©±" /><published>2015-03-18T00:00:00+09:00</published><updated>2019-08-20T00:00:00+09:00</updated><id>https://blog.toshimaru.net/coverage-with-codeclimate</id><content type="html" xml:base="https://blog.toshimaru.net/coverage-with-codeclimate/">&lt;p&gt;&lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone&quot;&gt;è¶£å‘³ã§ç«‹ã¡ä¸Šã’ã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ&lt;/a&gt;ã‚’ã“ã®åº¦ã€Coverallsã‹ã‚‰CodeClimateã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸã®ã§ã€ãã®çŸ¥è¦‹ã®å…±æœ‰ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ã©ã‚“ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã†ã‹&quot;&gt;ã©ã‚“ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã†ã‹&lt;/h2&gt;

&lt;p&gt;è‡ªåˆ†ãŒRails/Rubyãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ(not Private)ã‚’GitHubã«å…¬é–‹ã™ã‚‹ã¨ãã€å¿…ãšä½¿ã†SaaSç¾¤ãŒã‚ã£ã¦ã€ä¾‹ãˆã°CIã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã£ãŸã‚Šã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ã®è¨ˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã£ãŸã‚Šã‚³ãƒ¼ãƒ‰ã®å“è³ªã®è¨ˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã£ãŸã‚Šã™ã‚‹ã€‚ãã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ç¾¤ã‚’ã¾ã¨ã‚ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹ã€‚&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ã‚µãƒ¼ãƒ“ã‚¹&lt;/th&gt;
      &lt;th&gt;ç”¨é€”&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://travis-ci.org/repositories&quot;&gt;Travis CI&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;CIå›ã™&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://coveralls.io/&quot;&gt;Coveralls&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ã‚’è¨ˆæ¸¬&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://codeclimate.com/&quot;&gt;Code Climate&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;ã‚³ãƒ¼ãƒ‰å“è³ªã‚’è¨ˆæ¸¬&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;a href=&quot;https://gemnasium.com/dashboard&quot;&gt;Gemnasium&lt;/a&gt;&lt;/td&gt;
      &lt;td&gt;&lt;del&gt;Gemã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯&lt;/del&gt; æ—¢ã«closeã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã§ã™&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;â€» Publicãªãƒ¬ãƒã‚¸ãƒˆãƒªã§ã‚ã‚Œã°å…¨ã¦ç„¡æ–™ã§ä½¿ãˆã¾ã™&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cloud.githubusercontent.com/assets/803398/6694382/558b6f5c-cd1d-11e4-96ff-1e67d5905e83.png&quot; alt=&quot;badges&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ã€å›³ã€‘SaaSã®åˆ©ç”¨ã«ã‚ˆã‚Šè¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ãƒãƒƒã‚¸ç¾¤&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;coveralls--codeclimate&quot;&gt;Coveralls â†’ CodeClimate&lt;/h2&gt;

&lt;p&gt;ä»Šå›ãã®å†…ã®ï¼‘ã¤ã§ã‚ã‚‹Coverallsã‚’CodeClimateã«ç§»è¡Œã—ã¦ã¿ãŸã®ã§ã™ãŒã€ãã®ãã£ã‹ã‘ã¨ã—ã¦ã¯CircleCIã§CodeClimateã¨ã®ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¨å¥¨ã•ã‚Œã¦ã„ãŸã‹ã‚‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://docs.travis-ci.com/user/code-climate/&quot;&gt;Travis CI: Using Code Climate with Travis CI&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ã‚³ãƒ¼ãƒ‰å“è³ªã¨ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ã¯åˆ†æ•£ã™ã‚‹ã‚ˆã‚Šã‚‚ï¼‘ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹ã«é›†ç´„ã•ã‚Œã¦é–²è¦§ã§ããŸã»ã†ãŒéƒ½åˆãŒã‚ˆã„ã—ã€TravisCIã®å‹§ã‚ã‚‹CodeClimateã«çµ±åˆã—ã¦ã¿ã‚‹ã“ã¨ã¨ã—ãŸã€‚&lt;/p&gt;

&lt;h2 id=&quot;æ‰‹é †&quot;&gt;æ‰‹é †&lt;/h2&gt;

&lt;h3 id=&quot;set-code-climate-token&quot;&gt;Set Code Climate token&lt;/h3&gt;

&lt;p&gt;CodeClimateã®Settingsã‹ã‚‰ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã®TokenãŒã‚²ãƒƒãƒˆã§ãã‚‹ã®ã§ãã‚Œã‚’&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.travis.yml&lt;/code&gt;ã«ã‚»ãƒƒãƒˆã€‚&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;addons&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;code_climate&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;repo_token&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;adf08323...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;intall-codeclimate-reporter&quot;&gt;Intall CodeClimate reporter&lt;/h3&gt;

&lt;p&gt;codeclimate-test-reporter ã‚’&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Gemfile&lt;/code&gt;ã®test groupã«è¿½åŠ ã™ã‚‹ã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;gem&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;codeclimate-test-reporter&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;require: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;false&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;CodeClimateã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³é€šã‚Šã«æ›¸ãã¨ã“ã†ã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spec/rails_helper.rb&lt;/code&gt;ã«æ›¸ãã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;codeclimate-test-reporter&quot;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;CodeClimate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;TestReporter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;start&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;simplecovã¨åŒå±…ã•ã›ã‚‹&quot;&gt;Simplecovã¨åŒå±…ã•ã›ã‚‹&lt;/h3&gt;

&lt;p&gt;ç§ã®ç’°å¢ƒã®å ´åˆã€æ—¢ã«SimplecovãŒå…¥ã£ã¦ãŠã‚Šã¾ã—ãŸã®ã§ã€simplecovã¨ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã•ã›ã‚‹å ´åˆã¯ã¡ã‚‡ã£ã¨ç•°ãªã‚‹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'simplecov'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;codeclimate-test-reporter&quot;&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;SimpleCov&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;formatter&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;SimpleCov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Formatter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;MultiFormatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;SimpleCov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Formatter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;HTMLFormatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;no&quot;&gt;CodeClimate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;TestReporter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Formatter&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;SimpleCov&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;rails&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã“ã®ã‚ˆã†ã«SimpleCovã®formatterã«&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;CodeClimate::TestReporter::Formatter&lt;/code&gt;ã‚’å…¥ã‚Œã¦ã‚„ã‚Œã° :ok:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://cloud.githubusercontent.com/assets/803398/6694285/ad01584c-cd1c-11e4-9f29-1589821188da.png&quot; alt=&quot;codeclimate&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ã“ã‚Œã§Code Climateä¸Šã§å“è³ªãƒ»ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ãŒé–²è¦§ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚&lt;/p&gt;

&lt;h2 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://coderwall.com/p/vwhuqq/using-code-climate-s-new-test-reporter-together-with-coveralls-and-simplecov-s-html-formatter&quot;&gt;Using Code Climateâ€™s new test reporter together with Coveralls and SimpleCovâ€™s HTML Formatter&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>Toshimaru</name></author><category term="rspec" /><category term="ci" /><summary type="html">è¶£å‘³ã§ç«‹ã¡ä¸Šã’ã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã“ã®åº¦ã€Coverallsã‹ã‚‰CodeClimateã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸã®ã§ã€ãã®çŸ¥è¦‹ã®å…±æœ‰ã€‚</summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://cloud.githubusercontent.com/assets/803398/6655997/d4f38dc4-cb5b-11e4-8663-86fad6baf1f3.png" /><media:content medium="image" url="https://cloud.githubusercontent.com/assets/803398/6655997/d4f38dc4-cb5b-11e4-8663-86fad6baf1f3.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">RSpecãŒé€šã£ãŸã‚Šè½ã¡ãŸã‚Šã—ãŸã¨ãã«ã¯seedå€¤ã‚’æŒ‡å®šã™ã‚‹</title><link href="https://blog.toshimaru.net/rspec-occasional-fail/" rel="alternate" type="text/html" title="RSpecãŒé€šã£ãŸã‚Šè½ã¡ãŸã‚Šã—ãŸã¨ãã«ã¯seedå€¤ã‚’æŒ‡å®šã™ã‚‹" /><published>2014-09-23T00:00:00+09:00</published><updated>2014-09-23T00:00:00+09:00</updated><id>https://blog.toshimaru.net/rspec-occasional-fail</id><content type="html" xml:base="https://blog.toshimaru.net/rspec-occasional-fail/">&lt;p&gt;RSpecãŒãŸã¾ã«è½ã¡ãŸã‚Šé€šã£ãŸã‚Šã™ã‚‹ã€‚ãã‚“ãªã¨ãã¯RSpecã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †åºã«ã‚ˆã‚Šãƒ†ã‚¹ãƒˆãŒFailã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã€‚ã¤ã¾ã‚Šã‚ã‚‹ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œå¾Œã˜ã‚ƒãªã„ã¨é€šã‚‰ãªã„ã€ã¿ãŸã„ãªçŠ¶æ³ã«é™¥ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ã“ã‚Œã¯é †ç•ªã«ä¾å­˜ã—ãŸãƒ†ã‚¹ãƒˆãªã®ã§ã‚ˆã‚ã—ããªã„çŠ¶æ…‹ã§ã‚ã‚‹ã€‚&lt;/p&gt;

&lt;h2 id=&quot;ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±&quot;&gt;ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;rails (4.1.5)&lt;/li&gt;
  &lt;li&gt;rspec (3.1.0)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;random-order-rspec&quot;&gt;Random order RSpec&lt;/h2&gt;

&lt;p&gt;RSpecã‚’é †ç•ªã«ä¾å­˜ã•ã›ãªã„ãŸã‚ã«&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spec_helper.rb&lt;/code&gt;ã§ã“ã‚“ãªè¨­å®šãŒã•ã‚Œã¦ã„ã‚‹ã€‚&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Run specs in random order to surface order dependencies. If you find an&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# order dependency and want to debug it, you can fix the order by providing&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# the seed, which is printed after each run.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#     --seed 1234&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;random&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ã“ã®è¨­å®šã«ã‚ˆã‚Šãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®é †åºãŒãƒ©ãƒ³ãƒ€ãƒ ã«ãªã‚Šã€é †åºã«ä¾å­˜ã—ãªã„ãƒ†ã‚¹ãƒˆã®è¨˜è¿°ãŒå¯èƒ½ã¨ãªã‚‹ã€‚ã‚·ãƒ¼ãƒ‰å€¤ã¯ãƒ†ã‚¹ãƒˆã®æœ€å¾Œã«å¾—ã‚‰ã‚Œã‚‹ã€‚&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Randomized with seed 724
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;ã‚·ãƒ¼ãƒ‰å€¤ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œ&quot;&gt;ã‚·ãƒ¼ãƒ‰å€¤ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œ&lt;/h2&gt;

&lt;p&gt;Failã—ãŸãƒ†ã‚¹ãƒˆã®ã“ã®ã‚·ãƒ¼ãƒ‰å€¤ã‚’è¨­å®šã—ã¦ãƒ†ã‚¹ãƒˆã‚’èµ°ã‚‰ã›ã‚Œã°Failã—ãŸãƒ†ã‚¹ãƒˆã®é †ç•ªã‚’å†ç¾ã§ãã‚‹ã€‚&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ bundle exec rspec --seed 724 --fail-fast
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--seed&lt;/code&gt;ã§ã‚·ãƒ¼ãƒ‰å€¤ã‚’æŒ‡å®šã€&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--fail-fast&lt;/code&gt;ã‚’è¨­å®šã—ã¦Failã—ãŸã¨ãã«ãƒ†ã‚¹ãƒˆã‚’å³æ™‚çµ‚äº†ã•ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚&lt;/p&gt;

&lt;p&gt;ã“ã†ã™ã‚Œã°Failã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’å†ç¾ã§ãã¦ã€ã©ã®ãƒ†ã‚¹ãƒˆãŒã©ã“ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †ç•ªã«ä¾å­˜ã—ã¦è½ã¡ã¦ã„ã‚‹ã®ã‹ãŒã‚ã‹ã‚Šã¾ã™ã€‚&lt;/p&gt;

&lt;h2 id=&quot;å‚è€ƒ&quot;&gt;å‚è€ƒ&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://ikm.hatenablog.jp/entry/2013/03/26/003838&quot;&gt;ãƒ©ãƒ³ãƒ€ãƒ ã«è½ã¡ã‚‹specã®ä¿®æ­£ã§ä¾¿åˆ©ã ã£ãŸRSpecã®2ã¤ã®è¨­å®š&lt;/a&gt;&lt;/p&gt;</content><author><name>Toshimaru</name></author><category term="rspec" /><summary type="html">RSpecãŒãŸã¾ã«è½ã¡ãŸã‚Šé€šã£ãŸã‚Šã™ã‚‹ã€‚ãã‚“ãªã¨ãã¯RSpecã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †åºã«ã‚ˆã‚Šãƒ†ã‚¹ãƒˆãŒFailã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã€‚ã¤ã¾ã‚Šã‚ã‚‹ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œå¾Œã˜ã‚ƒãªã„ã¨é€šã‚‰ãªã„ã€ã¿ãŸã„ãªçŠ¶æ³ã«é™¥ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ã“ã‚Œã¯é †ç•ªã«ä¾å­˜ã—ãŸãƒ†ã‚¹ãƒˆãªã®ã§ã‚ˆã‚ã—ããªã„çŠ¶æ…‹ã§ã‚ã‚‹ã€‚</summary></entry><entry><title type="html">RSpec2ã‹ã‚‰RSpec3ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸Šã’ãŸã‚‰ãƒ†ã‚¹ãƒˆãŒFailã—ã¾ãã£ãŸè©±</title><link href="https://blog.toshimaru.net/rspec2-to-rspec3-errors/" rel="alternate" type="text/html" title="RSpec2ã‹ã‚‰RSpec3ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸Šã’ãŸã‚‰ãƒ†ã‚¹ãƒˆãŒFailã—ã¾ãã£ãŸè©±" /><published>2014-07-19T00:00:00+09:00</published><updated>2014-07-19T00:00:00+09:00</updated><id>https://blog.toshimaru.net/rspec2-to-rspec3-errors</id><content type="html" xml:base="https://blog.toshimaru.net/rspec2-to-rspec3-errors/">&lt;p&gt;éŠã³ã§ä½œã£ã¦ã‚‹Railsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®RSpecã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ï¼’ã‹ã‚‰ï¼“ã«ä¸Šã’ãŸã‚‰ã€ï¼’ã§ã¯å…¨éƒ¨é€šã£ã¦ãŸãƒ†ã‚¹ãƒˆãŒï¼“ã«ã—ãŸé€”ç«¯ãƒ†ã‚¹ãƒˆãŒ100å€‹ãã‚‰ã„Failã—ãŸã€‚ä¸€ä½“ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹ã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§RSpec3ã®æŒ™å‹•ã®é•ã„ã‚’èª¿ã¹ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec-rails&lt;/code&gt;ã‚’&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;bundle install&lt;/code&gt;ã—ãŸã‚ã¨&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rspec:install&lt;/code&gt;ã™ã‚‹ã€‚&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ rails g rspec:install
create  .rspec
create  spec
create  spec/spec_helper.rb
create  spec/rails_helper.rb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ä»Šã¾ã§ãªã‹ã£ãŸ&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rails_helper.rb&lt;/code&gt;ã£ã¦ã®ãŒä½œã‚‰ã‚Œã¦ã„ã‚‹ã€‚&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scaffold&lt;/code&gt;ã§ç”Ÿæˆã•ã‚Œã‚‹specãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ§‹æˆã¯ã“ã†ã€‚&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;spec
â”œâ”€â”€ controllers
â”‚Â Â  â””â”€â”€ users_controller_spec.rb
â”œâ”€â”€ helpers
â”‚Â Â  â””â”€â”€ users_helper_spec.rb
â”œâ”€â”€ models
â”‚Â Â  â””â”€â”€ user_spec.rb
â”œâ”€â”€ rails_helper.rb
â”œâ”€â”€ requests
â”‚Â Â  â””â”€â”€ users_spec.rb
â”œâ”€â”€ routing
â”‚Â Â  â””â”€â”€ users_routing_spec.rb
â”œâ”€â”€ spec_helper.rb
â””â”€â”€ views
    â””â”€â”€ users
        â”œâ”€â”€ edit.html.erb_spec.rb
        â”œâ”€â”€ index.html.erb_spec.rb
        â”œâ”€â”€ new.html.erb_spec.rb
        â””â”€â”€ show.html.erb_spec.rb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;è©¦ã—ã«&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spec/controllers/users_controller_spec.rb&lt;/code&gt;ã‚’é–‹ã„ã¦ã¿ã‚‹ã¨å†’é ­ãŒã“ã‚“ãªæ„Ÿã˜ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;require 'rails_helper'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;http://willnet.in/126&quot;&gt;RSpec 3 æ™‚ä»£ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« rails_helper.rb ã«ã¤ã„ã¦&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;ã¨ã„ã†ã‚ã‘ã§ã€ã“ã‚Œã¾ã§ require â€˜spec_helperâ€™ ã¨ã—ã¦ã„ãŸç®‡æ‰€ã®å¤§éƒ¨åˆ†ã¯ require â€˜rails_helperâ€™ ã«ç½®æ›ã—ã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã­ã€‚ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆ Ruby on Rails ã®ãƒ†ã‚¹ãƒˆã®ç« ã¯ require â€˜spec_helperâ€™ ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€RSpec 3 ã®ãƒªãƒªãƒ¼ã‚¹ç‰ˆã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯é©å®œèª­ã¿æ›¿ãˆã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spec_helper&lt;/code&gt;ã‚’&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rails_helper&lt;/code&gt;ã«å¤‰ãˆã¦ã€ãã‚Œã‚‰ã®ï¼’ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã‚’RSpec3ç”¨ã«è¦‹ç›´ã›ã°å…¨ã¦ã®ãƒ†ã‚¹ãƒˆãŒå•é¡Œãªãé€šã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€ã¨ã•ã€‚&lt;/p&gt;

&lt;p&gt;RSpec3ã‚ˆã‚Šruby1.8,ruby1.9ã‚’ã‚µãƒãƒ¼ãƒˆã—ãªããªã£ãŸã‚Šæ–°ã—ã„ãƒãƒƒãƒãƒ£ãƒ¼ãŒå¢—ãˆãŸã‚Šã—ã¦ã‚‹ã®ã§å¤‰æ›´ç‚¹ã‚’ä¸‹è¨˜ã‚ˆã‚Šå†åº¦ç¢ºèªã—ã¦ã¿ã‚‹ã¨ã‚ˆã„ã¨æ€ã„ã¾ã™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://myronmars.to/n/dev-blog/2014/05/notable-changes-in-rspec-3&quot;&gt;Notable Changes in RSpec 3&lt;/a&gt;&lt;/p&gt;</content><author><name>Toshimaru</name></author><category term="ruby" /><category term="rspec" /><summary type="html">éŠã³ã§ä½œã£ã¦ã‚‹Railsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®RSpecã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ï¼’ã‹ã‚‰ï¼“ã«ä¸Šã’ãŸã‚‰ã€ï¼’ã§ã¯å…¨éƒ¨é€šã£ã¦ãŸãƒ†ã‚¹ãƒˆãŒï¼“ã«ã—ãŸé€”ç«¯ãƒ†ã‚¹ãƒˆãŒ100å€‹ãã‚‰ã„Failã—ãŸã€‚ä¸€ä½“ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹ã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§RSpec3ã®æŒ™å‹•ã®é•ã„ã‚’èª¿ã¹ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚</summary></entry></feed>