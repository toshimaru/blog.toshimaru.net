<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.3">Jekyll</generator><link href="https://blog.toshimaru.net/feed/by_tag/rspec.xml" rel="self" type="application/atom+xml" /><link href="https://blog.toshimaru.net/" rel="alternate" type="text/html" /><updated>2023-12-31T17:21:42+09:00</updated><id>https://blog.toshimaru.net/feed/by_tag/rspec.xml</id><title type="html">Hack Your Design!</title><subtitle>toshimaruã®æŠ€è¡“ç³»ãªãƒ–ãƒ­ã‚°</subtitle><author><name>Toshimaru</name></author><entry><title type="html">Kaigi on Railsã§ã€ŒFactoryBot the Right Wayã€ã‚’ç™ºè¡¨ã—ã¾ã—ãŸ</title><link href="https://blog.toshimaru.net/kaigi-on-rails/" rel="alternate" type="text/html" title="Kaigi on Railsã§ã€ŒFactoryBot the Right Wayã€ã‚’ç™ºè¡¨ã—ã¾ã—ãŸ" /><published>2020-10-07T00:00:00+09:00</published><updated>2020-10-08T00:00:00+09:00</updated><id>https://blog.toshimaru.net/kaigi-on-rails</id><content type="html" xml:base="https://blog.toshimaru.net/kaigi-on-rails/"><![CDATA[<p><a href="https://kaigionrails.org/">Kaigi on Rails</a>ã§ã€ŒFactoryBot the Right Wayã€ã¨ã„ã†ã‚¿ã‚¤ãƒˆãƒ«ã§ç™ºè¡¨ã—ã¾ã—ãŸ<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>ã€‚</p>

<h2 id="ã‚¹ãƒ©ã‚¤ãƒ‰">ã‚¹ãƒ©ã‚¤ãƒ‰</h2>

<script async="" class="speakerdeck-embed" data-id="8084985a97ce4b6685d8528388da9779" data-ratio="1.77777777777778" src="//speakerdeck.com/assets/embed.js"></script>

<h2 id="ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å‹•ç”»">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–å‹•ç”»</h2>

<p>å‹•ç”»ã‚‚YouTubeã«ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã¨ã—ã¦ä¸ŠãŒã£ã¦ãŠã‚Šã¾ã™ã®ã§ã€éŸ³å£°ä»˜ãã§è´ããŸã„æ–¹ã¯ã“ã¡ã‚‰ã‚’ã©ã†ãã€‚</p>

<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">å…ˆè¡Œã—ã¦ <a href="https://twitter.com/toshimaru_e?ref_src=twsrc%5Etfw">@toshimaru_e</a> ã•ã‚“ã®å‹•ç”»ã‚’ã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸï¼ä»–ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚‚é †æ¬¡å…¬é–‹ã—ã¦ã„ãã¾ã™ã®ã§ãŠæ¥½ã—ã¿ã«ï¼ <a href="https://twitter.com/hashtag/kaigionrails?src=hash&amp;ref_src=twsrc%5Etfw">#kaigionrails</a><a href="https://t.co/duhoF1Xu1S">https://t.co/duhoF1Xu1S</a> <a href="https://t.co/y3PRYVRlO8">https://t.co/y3PRYVRlO8</a></p>&mdash; Kaigi on Rails (@kaigionrails) <a href="https://twitter.com/kaigionrails/status/1312397413592653824?ref_src=twsrc%5Etfw">October 3, 2020</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h2 id="æ„Ÿæƒ³">æ„Ÿæƒ³</h2>

<p>ä»Šå›ã¯åˆã®ãƒ“ãƒ‡ã‚ªéŒ²ç”»ç™»å£‡ã§ã—ãŸã€‚</p>

<p>ä»Šã¾ã§ã®ãƒªãƒ¢ãƒ¼ãƒˆç™»å£‡ï¼ˆ<a href="/career-strategy-for-around-thirty-engineer/">ã‚¢ãƒ©ã‚µãƒ¼ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®ç”Ÿå­˜æˆ¦ç•¥</a>ã€<a href="/how-to-deal-with-fat-model/">Fat Modelã®å€’ã—æ–¹</a>ï¼‰ã¯åŸºæœ¬Zoomã‚’ä½¿ã£ãŸLIVEç™»å£‡ã ã£ãŸã®ã§ã€ä»Šå›åˆã‚ã¦éŒ²ç”»ç™»å£‡ã‚’çµŒé¨“ã§ãã¦è‰¯ã‹ã£ãŸã¨æ€ã„ã¾ã™ã€‚</p>

<p>éŒ²ç”»ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨ã—ã¦ã¯ä¸‹è¨˜ã‚’åˆ©ç”¨ã—ã¾ã—ãŸã€‚</p>

<ul>
  <li>ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«: Keynote</li>
  <li>ã‚¹ãƒ©ã‚¤ãƒ‰éŒ²ç”»+éŸ³å£°éŒ²éŸ³: Keynoteã®ãƒ¬ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ©Ÿèƒ½ (with Krisp)
    <ul>
      <li>å‚è€ƒ: <a href="https://support.apple.com/ja-jp/guide/keynote/tan8a5df9cc5/mac">Macã®Keynoteã§ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚’éŒ²éŸ³ã™ã‚‹ - Apple ã‚µãƒãƒ¼ãƒˆ</a></li>
    </ul>
  </li>
  <li>Backupç”¨éŸ³å£°éŒ²éŸ³: QuickTime Player
    <ul>
      <li>å‚è€ƒ: <a href="https://support.apple.com/ja-jp/guide/quicktime-player/qtpf25d6f827/mac">Macã®QuickTime Playerã§ã‚ªãƒ¼ãƒ‡ã‚£ã‚ªã‚’éŒ²éŸ³ã™ã‚‹ - Apple ã‚µãƒãƒ¼ãƒˆ</a></li>
    </ul>
  </li>
  <li>ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼å´ã®å‹•ç”»æ’®å½±: iPad</li>
</ul>

<blockquote>
  <p>Kaigi on Railsã®ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆã¯ ã€Œåˆå­¦è€…ã‹ã‚‰ä¸Šç´šè€…ã¾ã§ãŒæ¥½ã—ã‚ã‚‹Webç³»ã®æŠ€è¡“ã‚«ãƒ³ãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã€ ã§ã™ã€‚</p>
</blockquote>

<p>ã¨ã„ã†ã“ã¨ã§ã—ãŸãŒã€ä»Šå›ã®ç™ºè¡¨ã®å†…å®¹çš„ã«ã¯åˆå­¦è€…ã‚‚ãã“ãã“æ¥½ã—ã‚ã‚‹å†…å®¹ã«ãªã£ã¦ã„ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚å‚è€ƒã«ãªã£ãŸã®ãªã‚‰å¹¸ã„ã§ã™<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>ã€‚</p>

<blockquote class="twitter-tweet" data-conversation="none"><p lang="ja" dir="ltr"><a href="https://twitter.com/hashtag/kaigionrails?src=hash&amp;ref_src=twsrc%5Etfw">#kaigionrails</a> ç™ºè¡¨è³‡æ–™ãƒãƒ©è¦‹ã›ã€‚FactoryBotã‚’ã‚ˆã‚Šä¸Šæ‰‹ã«ä½¿ã„ã“ãªã—ãŸã„åˆç´šè€…ã€œä¸­ç´šè€…ãƒ¬ãƒ™ãƒ«ã®æ–¹ã«ã¯ãã“ãã“æœ‰ç›Šãªæƒ…å ±ã«ãªã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã®ã§æ˜¯éğŸ˜Š <a href="https://t.co/dQDOzP3BpX">pic.twitter.com/dQDOzP3BpX</a></p>&mdash; toshimaru (@toshimaru_e) <a href="https://twitter.com/toshimaru_e/status/1311079864070369280?ref_src=twsrc%5Etfw">September 29, 2020</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h2 id="ãŠã‚ã‚Š">ãŠã‚ã‚Š</h2>

<p>Kaigi on Railsã‚’ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§é–‹å‚¬ã—ã¦ãã ã•ã£ãŸãƒãƒ¼ãƒ•ã‚ªãƒ¼ã‚¬ãƒŠã‚¤ã‚¶ãƒ¼ã® <a href="https://twitter.com/okuramasafumi">@okuramasafumi</a> ã‚’ã¯ã˜ã‚ã€é‹å–¶ã‚¹ã‚¿ãƒƒãƒ•ã®çš†ã•ã¾ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚</p>

<h2 id="å‚è€ƒãƒªãƒ³ã‚¯">å‚è€ƒãƒªãƒ³ã‚¯</h2>

<ul>
  <li>å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    <ul>
      <li><a href="https://github.com/thoughtbot/factory_bot/blob/master/GETTING_STARTED.md">GETTING_STARTED.md</a></li>
      <li><a href="https://github.com/thoughtbot/factory_bot/blob/master/NAME.md">Project Naming History</a></li>
    </ul>
  </li>
  <li>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
    <ul>
      <li><a href="https://github.com/toshimaru/factory-bot-the-right-way">toshimaru/factory-bot-the-right-way</a></li>
    </ul>
  </li>
  <li><a href="https://fukabori.fm/episode/13">13. ãƒšã‚¢ãƒ—ãƒ­ã‚„ãƒ†ã‚¹ãƒˆã®ç–‘å•ã¨ã‹ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã®è‚²æˆã¨ã‹ | fukabori.fm</a></li>
  <li><a href="https://sinsoku.hatenablog.com/entry/2017/04/09/214728">Rails ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ - éŒ†ã³ã¤ã„ãŸãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ (factory_girl) - ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«SEã®æ†‚é¬±</a></li>
  <li><a href="https://magazine.rubyist.net/articles/kaigi_on_rails/index.html">Rubyist Magazine: Kaigi on Rails ç‰¹é›†å·</a></li>
</ul>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>ãŸã¶ã‚“æ–‡æ³•çš„ã«ã¯ã€ŒFactoryBot <strong>in</strong> the right wayã€ã£ã¦ã®ãŒæ­£ã—ã„æ°—ãŒã™ã‚‹ã‘ã©ã€ã“ã¡ã‚‰ãŒã‚´ãƒ­ãŒè‰¯ã‹ã£ãŸã¨ã„ã†ã“ã¨ã§ãã‚Œã¯ã”æ„›å¬Œã§ã€‚ã€‚ã€‚Â <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>RailsDM2018ã§ç™ºè¡¨ã—ãŸã“ã¡ã‚‰ã®å†…å®¹ã‚‚ã‚ã‚ã›ã¦å‚è€ƒã«ã—ã¦ã„ãŸã ã‘ã‚‹ã¨ :pray: <a href="/rdm2018-active-record-anti-patterns/">railsdm2018ã§ã€ŒActiveRecordãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã‚’ç™ºè¡¨ã—ã¾ã—ãŸ</a>Â <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name>Toshimaru</name></author><category term="presentation" /><category term="rspec" /><category term="rails" /><summary type="html"><![CDATA[Kaigi on Railsã§ã€ŒFactoryBot the Right Wayã€ã¨ã„ã†ã‚¿ã‚¤ãƒˆãƒ«ã§ç™ºè¡¨ã—ã¾ã—ãŸã€‚å‹•ç”»ã‚‚YouTubeã«ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã¨ã—ã¦ä¸ŠãŒã£ã¦ãŠã‚Šã¾ã™ã®ã§ã€éŸ³å£°ä»˜ãã§è´ããŸã„æ–¹ã¯ã“ã¡ã‚‰ã‚’ã©ã†ãã€‚]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.toshimaru.net/images/posts/kaigi-on-rails.png" /><media:content medium="image" url="https://blog.toshimaru.net/images/posts/kaigi-on-rails.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Rails on Docker ç’°å¢ƒã§ã® SystemSpec ç’°å¢ƒæ§‹ç¯‰</title><link href="https://blog.toshimaru.net/rails-on-docker-system-spec/" rel="alternate" type="text/html" title="Rails on Docker ç’°å¢ƒã§ã® SystemSpec ç’°å¢ƒæ§‹ç¯‰" /><published>2019-09-18T00:00:00+09:00</published><updated>2019-09-18T00:00:00+09:00</updated><id>https://blog.toshimaru.net/rails-on-docker-system-spec</id><content type="html" xml:base="https://blog.toshimaru.net/rails-on-docker-system-spec/"><![CDATA[<p>Rails on Docker ãªç’°å¢ƒä¸Šã« SystemSpec(System Test + RSpec) ã‚’å°å…¥ã—ã¾ã—ãŸã€‚</p>

<h2 id="ç’°å¢ƒ">ç’°å¢ƒ</h2>

<p>ä»Šå›SystemSpecã‚’å°å…¥ã—ãŸã®ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªç’°å¢ƒã§ã™ã€‚</p>

<ul>
  <li>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: <a href="https://github.com/toshimaru/RailsTwitterClone/">RailsTwitterClone</a></li>
  <li>docker-compose</li>
  <li>Ruby 2.6</li>
  <li>chromium-driver</li>
  <li>gem
    <ul>
      <li>rails (5.2)</li>
      <li>rspec-rails</li>
      <li>selenium-webdriver</li>
      <li>capybara</li>
    </ul>
  </li>
</ul>

<h2 id="å¯¾å¿œpull-request">å¯¾å¿œPull Request</h2>

<p><a href="https://github.com/toshimaru/RailsTwitterClone/pull/506/files">Re-try System Spec by toshimaru Â· Pull Request #506 Â· toshimaru/RailsTwitterClone</a></p>

<h2 id="ç§ã®systemspecé…ã™ã">ç§ã®SystemSpecã€é…ã™ãâ€¦ï¼Ÿ</h2>

<p>å®Ÿã¯ SystemSpec ã‚’å°å…¥ã—ã‚ˆã†ã¨è©¦ã¿ãŸã®ã¯ä»Šå›ã§äºŒå›ç›®ã§ã™ã€‚ä¸€å›ç›®ã¯ SystemTest ãŒ Rails ã®æ©Ÿèƒ½ã®ä¸€ã¤ã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦é–“ã‚‚ãªã„é ƒã«è©¦ã—ãŸã®ã§ã™ãŒã€ãƒ†ã‚¹ãƒˆå…¨ä½“ã«ã‹ã‹ã‚‹æ™‚é–“ãŒåŠ‡çš„ã«é…ããªã£ãŸãŸã‚ã€å°å…¥ã‚’æ–­å¿µã—ãŸã¨ã„ã†çµŒç·¯ãŒã‚ã‚Šã¾ã™ã€‚</p>

<p>å½“æ™‚ã®Pull RequestãŒã“ã¡ã‚‰: <a href="https://github.com/toshimaru/RailsTwitterClone/pull/216">Try System Spec by toshimaru Â· Pull Request #216 Â· toshimaru/RailsTwitterClone</a></p>

<blockquote>
  <p>Before</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Finished in 15.74 seconds (files took 7.65 seconds to load)
152 examples, 0 failures
</code></pre></div>  </div>

  <p>After</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Finished in 58.46 seconds (files took 7.64 seconds to load)
152 examples, 3 failures
</code></pre></div>  </div>
</blockquote>

<p>ã—ã‹ã—ã“ã‚Œã¯çµæœã‹ã‚‰ã„ã†ã¨è¨­å®šãŒæ‚ªã‹ã£ãŸã®ã§ã—ãŸã€‚ä¸‹è¨˜ã®ã‚ˆã†ã« system ãƒ†ã‚¹ãƒˆã‚’ Headless Chrome ã§èµ°ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ã¾ã—ãŸãŒã€ã“ã‚Œã ã¨ã™ã¹ã¦ã® System ãƒ†ã‚¹ãƒˆãŒ Headless Chrome ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã¦ã—ã¾ã„ã€çµæœçš„ã«é…ããªã‚Šã¾ã™ã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="o">...</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">before</span><span class="p">(</span><span class="ss">:each</span><span class="p">,</span> <span class="ss">type: :system</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">driven_by</span> <span class="ss">:selenium_chrome_headless</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>ä¸‹è¨˜ã®ã‚ˆã†ã«JSã‚’èµ·å‹•ã•ã›ã‚‹å¿…è¦ã®ãªã„ System ãƒ†ã‚¹ãƒˆã¯å¾“æ¥é€šã‚Šã®<code class="language-plaintext highlighter-rouge">rack_test</code>ã€<code class="language-plaintext highlighter-rouge">js: true</code>ãªãƒ†ã‚¹ãƒˆã¯<code class="language-plaintext highlighter-rouge">selenium_chrome_headless</code>ã«è¨­å®šã—ã¦ã‚„ã‚Œã°ãƒ†ã‚¹ãƒˆå…¨ä½“ãŒé«˜é€Ÿã«å®Ÿè¡Œå¯èƒ½ã«ãªã‚Šã¾ã—ãŸã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="o">...</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">before</span><span class="p">(</span><span class="ss">:each</span><span class="p">,</span> <span class="ss">type: :system</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">driven_by</span> <span class="ss">:rack_test</span>
  <span class="k">end</span>

  <span class="n">config</span><span class="p">.</span><span class="nf">before</span><span class="p">(</span><span class="ss">:each</span><span class="p">,</span> <span class="ss">type: :system</span><span class="p">,</span> <span class="ss">js: </span><span class="kp">true</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">driven_by</span> <span class="ss">:selenium_chrome_headless</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<h2 id="dockerfile">Dockerfile</h2>

<p>ä»Šå›åˆ©ç”¨ã—ãŸ <code class="language-plaintext highlighter-rouge">Dockerfile</code> ã¯ Ruby 2.6 ã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã« <code class="language-plaintext highlighter-rouge">chromium-driver</code> ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã‚³ãƒ³ãƒ†ãƒŠã¨ãªã‚Šã¾ã™ã€‚</p>

<div class="language-dockerfile highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">FROM</span><span class="s"> ruby:2.6</span>

<span class="k">RUN </span>apt-get update <span class="nt">-qq</span> <span class="o">&amp;&amp;</span> apt-get <span class="nb">install</span> <span class="nt">-y</span> nodejs chromium-driver 
</code></pre></div></div>

<h3 id="chrome-failed-to-start-exited-abnormally">Chrome failed to start: exited abnormally</h3>

<p>ã—ã‹ã—ã€ä¸Šè¿°ã®ç’°å¢ƒã«ãŠã„ã¦<code class="language-plaintext highlighter-rouge">rspec</code>ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Failure/Error: Unable to infer file and line number from backtrace

  Selenium::WebDriver::Error::UnknownError:
      unknown error: Chrome failed to start: exited abnormally
      (unknown error: DevToolsActivePort file doesn't exist)
      (The process started from chrome location /usr/bin/chromium is no longer running, so ChromeDriver is assuming that Chrome has crashed.)
</code></pre></div></div>

<p>ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ Chrome ãŒ<code class="language-plaintext highlighter-rouge">sandbox</code>ãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã«èµ·å› ã—ã¾ã™ã€‚ä¸‹è¨˜ã®ã‚ˆã†ãª<code class="language-plaintext highlighter-rouge">no-sandbox</code>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»˜ãã® Headless Chrome ã‚’ Capybara ã« driver ã¨ã—ã¦ç™»éŒ²ã—ã¦ã‚„ã‚‹ã“ã¨ã§å›é¿ã—ã¾ã™ã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Capybara</span><span class="p">.</span><span class="nf">register_driver</span> <span class="ss">:headless_chrome</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="n">browser_options</span> <span class="o">=</span> <span class="o">::</span><span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Chrome</span><span class="o">::</span><span class="no">Options</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">tap</span> <span class="k">do</span> <span class="o">|</span><span class="n">opts</span><span class="o">|</span>
    <span class="n">opts</span><span class="p">.</span><span class="nf">args</span> <span class="o">&lt;&lt;</span> <span class="s2">"--headless"</span>
    <span class="n">opts</span><span class="p">.</span><span class="nf">args</span> <span class="o">&lt;&lt;</span> <span class="s2">"--disable-gpu"</span>
    <span class="n">opts</span><span class="p">.</span><span class="nf">args</span> <span class="o">&lt;&lt;</span> <span class="s2">"--no-sandbox"</span>
  <span class="k">end</span>
  <span class="no">Capybara</span><span class="o">::</span><span class="no">Selenium</span><span class="o">::</span><span class="no">Driver</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="ss">browser: :chrome</span><span class="p">,</span> <span class="ss">options: </span><span class="n">browser_options</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>ã“ã†ã—ã¦ç™»éŒ²ã—ãŸ<code class="language-plaintext highlighter-rouge">headless_chrome</code>ã‚’SystemTestã«å¯¾ã—ã¦é©å¿œã•ã›ã¦ã‚„ã‚Œã°OKã§ã™ã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">RSpec</span><span class="p">.</span><span class="nf">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="o">...</span>
  <span class="n">config</span><span class="p">.</span><span class="nf">before</span><span class="p">(</span><span class="ss">:each</span><span class="p">,</span> <span class="ss">type: :system</span><span class="p">,</span> <span class="ss">js: </span><span class="kp">true</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">driven_by</span> <span class="ss">:headless_chrome</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>ã“ã‚Œã§ãã¡ã‚“ã¨Dockerä¸Šã§SystemSpecãŒé€šã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>docker-compose run web rspec
<span class="go">
Randomized with seed 30150
............................................................................................................Capybara starting Puma...
* Version 4.1.1 , codename: Fourth and One
* Min threads: 0, max threads: 4
* Listening on tcp://127.0.0.1:38789
</span><span class="c">...............................................
</span><span class="go">
Finished in 19.87 seconds (files took 8.8 seconds to load)
155 examples, 0 failures
</span></code></pre></div></div>

<h2 id="å…¬å¼ã§ã¯no-sandboxã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ã¯ã—ã¦ãã‚Œãªã„">å…¬å¼ã§ã¯no-sandboxã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ã¯ã—ã¦ãã‚Œãªã„ï¼Ÿ</h2>

<p>ä½™è«‡ã§ã™ãŒã€Capybaraæœ¬ä½“ã§ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹<code class="language-plaintext highlighter-rouge">selenium_chrome_headless</code>ã«<code class="language-plaintext highlighter-rouge">no-sandbox</code>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä»˜ä¸ã™ã‚‹å¤‰æ›´ã‚’PRã—ã¦ã¿ã¾ã—ãŸãŒã€ä¸‹è¨˜ã®é€šã‚ŠRejectã•ã‚Œã¦ã—ã¾ã„ã¾ã—ãŸã€‚</p>

<p><a href="https://github.com/teamcapybara/capybara/pull/2241">Add <code class="language-plaintext highlighter-rouge">no-sandbox</code> option for selenium_chrome_headless by toshimaru Â· Pull Request #2241 Â· teamcapybara/capybara</a></p>

<h3 id="securityã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã®sandbox">Securityã‚’æ‹…ä¿ã™ã‚‹ãŸã‚ã®sandbox</h3>

<p>sandboxã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’é«˜ã‚ã‚‹ãŸã‚ã®ç’°å¢ƒãªã®ã§åŸºæœ¬çš„ã«ã¯ <strong>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ no-sandbox ã«ã™ã‚‹ã¹ãã§ã¯ãªã„</strong> ã¨ã„ã†åˆ¤æ–­ã®ã‚ˆã†ã§ã™ã€‚</p>

<blockquote>
  <p>Sandbox leverages the OS-provided security to allow code execution that cannot make persistent changes to the computer or access information that is confidential.</p>
</blockquote>

<p>via. <a href="https://chromium.googlesource.com/chromium/src/+/master/docs/design/sandbox.md">Sandbox</a></p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<ul>
  <li><a href="https://qiita.com/ngron/items/f61b8635b4d67f666d75">Rails + Selenium + Dockerã§SystemSpecã®ç’°å¢ƒæ§‹ç¯‰ - Qiita</a></li>
  <li><a href="https://news.mynavi.jp/article/20081009-a027/">Google Chrome ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹ã§å®Ÿç¾ã™ã‚‹ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€Windowsã®æ©Ÿèƒ½ã«ä¾å­˜ | ãƒã‚¤ãƒŠãƒ“ãƒ‹ãƒ¥ãƒ¼ã‚¹</a></li>
</ul>]]></content><author><name>Toshimaru</name></author><category term="rspec" /><category term="rails" /><category term="docker" /><summary type="html"><![CDATA[Rails on Docker ãªç’°å¢ƒä¸Šã« SystemSpec(System Test + RSpec) ã‚’å°å…¥ã—ã¾ã—ãŸã€‚ ç’°å¢ƒ ä»Šå›SystemSpecã‚’å°å…¥ã—ãŸã®ã¯ä¸‹è¨˜ã®ã‚ˆã†ãªç’°å¢ƒã§ã™ã€‚ç§ã®SystemSpecã€é…ã™ãâ€¦ï¼Ÿ å®Ÿã¯ SystemSpec ã‚’å°å…¥ã—ã‚ˆã†ã¨è©¦ã¿ãŸã®ã¯ä»Šå›ã§äºŒå›ç›®ã§ã™ã€‚ä¸€å›ç›®ã¯ SystemTest ãŒ Rails ã®æ©Ÿèƒ½ã®ä¸€ã¤ã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦é–“ã‚‚ãªã„é ƒã«è©¦ã—ãŸã®ã§ã™ãŒã€ãƒ†ã‚¹ãƒˆå…¨ä½“ã«ã‹ã‹ã‚‹æ™‚é–“ãŒåŠ‡çš„ã«é…ããªã£ãŸãŸã‚ã€å°å…¥ã‚’æ–­å¿µã—ãŸã¨ã„ã†çµŒç·¯ãŒã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã“ã‚Œã¯çµæœã‹ã‚‰ã„ã†ã¨è¨­å®šãŒæ‚ªã‹ã£ãŸã®ã§ã—ãŸã€‚]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.toshimaru.net/images/posts/systemspec/og.jpg" /><media:content medium="image" url="https://blog.toshimaru.net/images/posts/systemspec/og.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Rails E2Eãƒ†ã‚¹ãƒˆã§ poltergeist ã‹ã‚‰ Headless Chrome ã¸ã¨ä¹—ã‚Šæ›ãˆã‚‹</title><link href="https://blog.toshimaru.net/poltergeist-to-selenium-webdriver/" rel="alternate" type="text/html" title="Rails E2Eãƒ†ã‚¹ãƒˆã§ poltergeist ã‹ã‚‰ Headless Chrome ã¸ã¨ä¹—ã‚Šæ›ãˆã‚‹" /><published>2018-08-04T00:00:00+09:00</published><updated>2019-09-17T00:00:00+09:00</updated><id>https://blog.toshimaru.net/poltergeist-to-selenium-webdriver</id><content type="html" xml:base="https://blog.toshimaru.net/poltergeist-to-selenium-webdriver/"><![CDATA[<p>Railsã®Capybaraã‚’ä½¿ã£ãŸE2Eãƒ†ã‚¹ãƒˆ(feature spec)ã‚’ã“ã®åº¦ã€<a href="https://github.com/teampoltergeist/poltergeist">poltergeist</a>ã‹ã‚‰<a href="https://chromium.googlesource.com/chromium/src/+/master/headless/README.md">Headless Chrome</a>ã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸã®ã§ãã®ã¨ãã®ãƒ¡ãƒ¢ã€‚</p>

<h2 id="å¯¾å¿œ-pull-request">å¯¾å¿œ Pull Request</h2>

<p>ä»Šå›å¯¾å¿œã—ãŸPull Requestã¯ã“ã¡ã‚‰ã€‚</p>

<p><a href="https://github.com/toshimaru/RailsTwitterClone/pull/211">Use headless Chrome instead of PhantomJS(poltergeist) by toshimaru Â· Pull Request #211 Â· toshimaru/RailsTwitterClone Â· GitHub</a></p>

<p>æ€ã£ãŸã‚ˆã‚Šã‚‚å·®åˆ†ã¯ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«ã¾ã¨ã¾ã‚Šã¾ã—ãŸã€‚</p>

<h2 id="install-selenium-webdriver">Install selenium-webdriver</h2>

<p>ã¾ãšã¯<code class="language-plaintext highlighter-rouge">poltergeist</code> gemã®ä»£ã‚ã‚Šã«ã€<code class="language-plaintext highlighter-rouge">selenium-webdriver</code>ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">-  gem "poltergeist"
</span><span class="gi">+  gem "selenium-webdriver"
</span></code></pre></div></div>

<h2 id="change-capybarajavascript_driver">Change Capybara.javascript_driver</h2>

<p>æ¬¡ã«<code class="language-plaintext highlighter-rouge">Capybara.javascript_driver</code>ã‚’<code class="language-plaintext highlighter-rouge">:poltergeist</code>ã‹ã‚‰<code class="language-plaintext highlighter-rouge">:selenium_chrome_headless</code>ã«å¤‰æ›´ã—ã¾ã™ã€‚</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- require "capybara/poltergeist"
- Capybara.javascript_driver = :poltergeist
</span><span class="gi">+ require "selenium-webdriver"
+ Capybara.javascript_driver = :selenium_chrome_headless
</span></code></pre></div></div>

<p>ã¡ãªã¿ã«<code class="language-plaintext highlighter-rouge">:selenium_chrome_headless</code>ã®è¨­å®šã¯ä¸‹è¨˜ã®å¤‰æ›´ã®ä¸­ã§capybaraå†…ã«å–ã‚Šè¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Capybara</span><span class="p">.</span><span class="nf">register_driver</span> <span class="ss">:selenium_chrome_headless</span> <span class="k">do</span> <span class="o">|</span><span class="n">app</span><span class="o">|</span>
  <span class="n">browser_options</span> <span class="o">=</span> <span class="o">::</span><span class="no">Selenium</span><span class="o">::</span><span class="no">WebDriver</span><span class="o">::</span><span class="no">Chrome</span><span class="o">::</span><span class="no">Options</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">browser_options</span><span class="p">.</span><span class="nf">args</span> <span class="o">&lt;&lt;</span> <span class="s1">'--headless'</span>
  <span class="n">browser_options</span><span class="p">.</span><span class="nf">args</span> <span class="o">&lt;&lt;</span> <span class="s1">'--disable-gpu'</span>
  <span class="no">Capybara</span><span class="o">::</span><span class="no">Selenium</span><span class="o">::</span><span class="no">Driver</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="ss">browser: :chrome</span><span class="p">,</span> <span class="ss">options: </span><span class="n">browser_options</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>via. <a href="https://github.com/teamcapybara/capybara/commit/0275eab42c610cd1ccde7947b051d0b00857b9ce">add default selenium chrome driver registrations Â· teamcapybara/capybara@0275eab Â· GitHub</a></p>

<h2 id="install-chromedriver">Install chromedriver</h2>

<h3 id="on-macos">On MacOS</h3>

<p><code class="language-plaintext highlighter-rouge">chromedriver</code> ãŒå¿…è¦ã«ãªã£ã¦ãã‚‹ãŒã€Macã®å ´åˆã¯brewã§å…¥ã‚Œã¡ã‚ƒã†ã®ãŒä¸€ç•ªãƒ©ã‚¯ã§ã™ã€‚</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>brew cask <span class="nb">install </span>chromedriver
<span class="go">Updating Homebrew...
</span><span class="gp">==&gt;</span><span class="w"> </span>Auto-updated Homebrew!
<span class="go">Updated 1 tap (homebrew/cask).
No changes to formulae.

</span><span class="gp">==&gt;</span><span class="w"> </span>Satisfying dependencies
<span class="gp">==&gt;</span><span class="w"> </span>Downloading https://chromedriver.storage.googleapis.com/2.41/chromedriver_mac64.zip
<span class="gp">#</span><span class="c">####################################################################### 100.0%</span>
<span class="gp">==&gt;</span><span class="w"> </span>Verifying checksum <span class="k">for </span>Cask chromedriver
<span class="gp">==&gt;</span><span class="w"> </span>Installing Cask chromedriver
<span class="gp">==&gt;</span><span class="w"> </span>Extracting nested container chromedriver
<span class="gp">==&gt;</span><span class="w"> </span>Linking Binary <span class="s1">'chromedriver'</span> to <span class="s1">'/usr/local/bin/chromedriver'</span><span class="nb">.</span>
<span class="go">ğŸº  chromedriver was successfully installed!
</span></code></pre></div></div>

<p><strong>æ³¨æ„äº‹é …</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">brew install chromedriver</code>ã§ã¯installã§ããªã„ã®ã§æ³¨æ„ï¼ˆ<code class="language-plaintext highlighter-rouge">brew cask</code>çµŒç”±ã«ã™ã‚‹ã“ã¨ï¼‰</li>
  <li><code class="language-plaintext highlighter-rouge">chromedriver-helper</code> gem ãŒå…¥ã£ã¦ã„ã‚‹ã¨ã†ã¾ãå‹•ã‹ãªã„å ´åˆãŒã‚ã‚‹ã®ã§æ³¨æ„</li>
</ul>

<h3 id="on-circleci">On CircleCI</h3>

<p>CircleCIä¸Šã§ã¯ã€<code class="language-plaintext highlighter-rouge">ruby:x.x-node-browsers</code>ã®CircleCIå…¬å¼Ruby Dokcer Imageã‚’ä½¿ã£ã¦ã„ã‚Œã°ãã¡ã‚“ã¨å‹•ä½œã—ã¾ã—ãŸã€‚</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="na">docker</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">image</span><span class="pi">:</span> <span class="s">circleci/ruby:2.5-node-browsers</span>
</code></pre></div></div>

<p>ä¸Šè¨˜ã®è¨­å®šã®å ´åˆã€Ruby2.5ã®node-browsersãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚</p>

<h3 id="on-travisci">On TravisCI</h3>

<p>ã“ã‚ŒãŒä»Šå›ã®å¯¾å¿œã§ä¸€ç•ªãƒãƒã£ãŸè¨­å®šã§ã—ãŸã€‚ã„ã‚ã„ã‚è©¦ã—ã¾ã—ãŸãŒä¸‹è¨˜ã®ã‚¨ãƒ©ãƒ¼ãŒãªã‹ãªã‹è§£æ±ºã§ãã¾ã›ã‚“ã§ã—ãŸã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Failures:

  1) Authentication authorization screenshot
     Failure/Error: before { visit signin_path }

     Selenium::WebDriver::Error::WebDriverError:
        Unable to find Mozilla geckodriver. Please download the server from https://github.com/mozilla/geckodriver/releases and place it somewhere on your PATH. More info at https://developer.mozilla.org/en-US/docs/Mozilla/QA/Marionette/WebDriver.
     # ./spec/features/authentication_pages_spec.rb:9:in `block (3 levels) in &lt;top (required)&gt;'
</code></pre></div></div>

<p><del>æœ¬å½“ã¯<code class="language-plaintext highlighter-rouge">sudo: false</code>ã®è¨­å®šã§å‹•ã‹ã—ãŸã‹ã£ãŸã®ã§ã™ãŒãã‚Œã ã¨ä¸Šæ‰‹ãã„ã‹ãªã‹ã£ãŸã®ã§<code class="language-plaintext highlighter-rouge">sudo</code>ã§èµ·å‹•ã•ã›ã¦<code class="language-plaintext highlighter-rouge">chromium-chromedriver</code>ã‚’ãƒ†ã‚¹ãƒˆå‰ã«Installã—ã¦ãƒ‘ã‚¹ã‚’é€šã™ã¨ã„ã†æ–¹æ³•ã§ãƒ†ã‚¹ãƒˆã‚’é€šã—ã¾ã—ãŸã€‚</del></p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">sudo</span><span class="pi">:</span> <span class="s">required</span>
<span class="na">language</span><span class="pi">:</span> <span class="s">ruby</span>
<span class="na">before_install</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">sudo apt-get install -y chromium-chromedriver</span>
  <span class="pi">-</span> <span class="s">ln -s /usr/lib/chromium-browser/chromedriver ~/bin/chromedriver</span>
</code></pre></div></div>

<p><del>(ã‚‚ã†å°‘ã—ã‚¹ãƒãƒ¼ãƒˆãªã‚„ã‚Šæ–¹ã‚’ã”å­˜çŸ¥ã®æ–¹ã¯æ•™ãˆã¦ã„ãŸã ã‘ã‚‹ã¨å¬‰ã—ã„ã§ã™ğŸ™)</del></p>

<p><strong>è¿½è¨˜ï¼ˆ2019å¹´9æœˆ17æ—¥ï¼‰</strong></p>

<p><code class="language-plaintext highlighter-rouge">sudo</code> ç„¡ã—ã§ã‚‚ä¸‹è¨˜ã®ã‚ˆã†ãªè¨­å®šã§ã„ã‘ã¾ã—ãŸã€‚</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">dist</span><span class="pi">:</span> <span class="s">bionic</span>
<span class="na">addons</span><span class="pi">:</span>
  <span class="na">chrome</span><span class="pi">:</span> <span class="s">stable</span>
  <span class="na">apt</span><span class="pi">:</span>
    <span class="na">packages</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">chromium-chromedriver</span>
</code></pre></div></div>

<p>å‚è€ƒPull Request: <a href="https://github.com/toshimaru/RailsTwitterClone/pull/524/files">No sudo on TravisCI by toshimaru Â· Pull Request #524 Â· toshimaru/RailsTwitterClone</a></p>

<h2 id="å‚è€ƒãƒªãƒ³ã‚¯">å‚è€ƒãƒªãƒ³ã‚¯</h2>

<ul>
  <li><a href="https://ohbarye.hatenablog.jp/entry/2018/03/10/232300">PhantomJS + Poltergeist ã‚’ Selenium + Headless Chrome ã§ç½®ãæ›ãˆã‚‹ (1) Rails + Capybara ã«ã‚ˆã‚‹ feature spec ç·¨ - valid,invalid</a></li>
  <li><a href="https://tech.speee.jp/entry/2017/06/15/135636">RSpec ã® feature spec ã§ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ Chrome ã‚’ä½¿ã† - Speee DEVELOPER BLOG</a></li>
  <li><a href="http://y-yagi.tumblr.com/post/166831012790/rails%E9%9B%91%E3%81%ABsystem-test%E3%81%A7headless-chrome%E3%82%92%E4%BD%BF%E3%81%86">[Rails]é›‘ã«System Testã§Headless Chromeã‚’ä½¿ã† | æ—¥ã€…é›‘è¨˜</a></li>
</ul>]]></content><author><name>Toshimaru</name></author><category term="rails" /><category term="rspec" /><category term="chrome" /><summary type="html"><![CDATA[Railsã®Capybaraã‚’ä½¿ã£ãŸE2Eãƒ†ã‚¹ãƒˆ(feature spec)ã‚’ã“ã®åº¦ã€poltergeistã‹ã‚‰Headless Chromeã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸã®ã§ãã®ã¨ãã®ãƒ¡ãƒ¢ã€‚ ä»Šå›å¯¾å¿œã—ãŸPull Requestã—ã¦ã¯ã“ã¡ã‚‰ã€‚ https://github.com/toshimaru/RailsTwitterClone/pull/211 æ€ã£ãŸã‚ˆã‚Šã‚‚å·®åˆ†ã¯ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã«ã¾ã¨ã¾ã£ãŸã€‚ã¾ãšã¯poltergeist gemã®ä»£ã‚ã‚Šã«ã€selenium-webdriverã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚æ¬¡ã«Capybara.javascript_driverã‚’:poltergeistã‹ã‚‰:selenium_chrome_headlessã«å¤‰æ›´ã€‚]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://blog.toshimaru.net/images/posts/chromedriver.jpg" /><media:content medium="image" url="https://blog.toshimaru.net/images/posts/chromedriver.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡è¨ˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹ã‚’Coverallsã‹ã‚‰CodeClimateã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸè©±</title><link href="https://blog.toshimaru.net/coverage-with-codeclimate/" rel="alternate" type="text/html" title="ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡è¨ˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹ã‚’Coverallsã‹ã‚‰CodeClimateã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸè©±" /><published>2015-03-18T00:00:00+09:00</published><updated>2019-08-20T00:00:00+09:00</updated><id>https://blog.toshimaru.net/coverage-with-codeclimate</id><content type="html" xml:base="https://blog.toshimaru.net/coverage-with-codeclimate/"><![CDATA[<p><a href="https://github.com/toshimaru/RailsTwitterClone">è¶£å‘³ã§ç«‹ã¡ä¸Šã’ã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</a>ã‚’ã“ã®åº¦ã€Coverallsã‹ã‚‰CodeClimateã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸã®ã§ã€ãã®çŸ¥è¦‹ã®å…±æœ‰ã€‚</p>

<h2 id="ã©ã‚“ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã†ã‹">ã©ã‚“ãªã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½¿ã†ã‹</h2>

<p>è‡ªåˆ†ãŒRails/Rubyãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ(not Private)ã‚’GitHubã«å…¬é–‹ã™ã‚‹ã¨ãã€å¿…ãšä½¿ã†SaaSç¾¤ãŒã‚ã£ã¦ã€ä¾‹ãˆã°CIã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã£ãŸã‚Šã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ã®è¨ˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã£ãŸã‚Šã‚³ãƒ¼ãƒ‰ã®å“è³ªã®è¨ˆæ¸¬ã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã£ãŸã‚Šã™ã‚‹ã€‚ãã‚Œã‚‰ã®ã‚µãƒ¼ãƒ“ã‚¹ç¾¤ã‚’ã¾ã¨ã‚ã‚‹ã¨ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚‹ã€‚</p>

<table>
  <thead>
    <tr>
      <th>ã‚µãƒ¼ãƒ“ã‚¹</th>
      <th>ç”¨é€”</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://travis-ci.org/repositories">Travis CI</a></td>
      <td>CIå›ã™</td>
    </tr>
    <tr>
      <td><a href="https://coveralls.io/">Coveralls</a></td>
      <td>ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ã‚’è¨ˆæ¸¬</td>
    </tr>
    <tr>
      <td><a href="https://codeclimate.com/">Code Climate</a></td>
      <td>ã‚³ãƒ¼ãƒ‰å“è³ªã‚’è¨ˆæ¸¬</td>
    </tr>
    <tr>
      <td><a href="https://gemnasium.com/dashboard">Gemnasium</a></td>
      <td><del>Gemã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯</del> æ—¢ã«closeã•ã‚ŒãŸã‚µãƒ¼ãƒ“ã‚¹ã§ã™</td>
    </tr>
  </tbody>
</table>

<p><strong>â€» Publicãªãƒ¬ãƒã‚¸ãƒˆãƒªã§ã‚ã‚Œã°å…¨ã¦ç„¡æ–™ã§ä½¿ãˆã¾ã™</strong></p>

<p><img src="https://cloud.githubusercontent.com/assets/803398/6694382/558b6f5c-cd1d-11e4-96ff-1e67d5905e83.png" alt="badges" /></p>

<p><strong>ã€å›³ã€‘SaaSã®åˆ©ç”¨ã«ã‚ˆã‚Šè¡¨ç¤ºã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ãƒãƒƒã‚¸ç¾¤</strong></p>

<h2 id="coveralls--codeclimate">Coveralls â†’ CodeClimate</h2>

<p>ä»Šå›ãã®å†…ã®ï¼‘ã¤ã§ã‚ã‚‹Coverallsã‚’CodeClimateã«ç§»è¡Œã—ã¦ã¿ãŸã®ã§ã™ãŒã€ãã®ãã£ã‹ã‘ã¨ã—ã¦ã¯CircleCIã§CodeClimateã¨ã®ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ¨å¥¨ã•ã‚Œã¦ã„ãŸã‹ã‚‰ã€‚</p>

<p><a href="http://docs.travis-ci.com/user/code-climate/">Travis CI: Using Code Climate with Travis CI</a></p>

<p>ã‚³ãƒ¼ãƒ‰å“è³ªã¨ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ã¯åˆ†æ•£ã™ã‚‹ã‚ˆã‚Šã‚‚ï¼‘ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹ã«é›†ç´„ã•ã‚Œã¦é–²è¦§ã§ããŸã»ã†ãŒéƒ½åˆãŒã‚ˆã„ã—ã€TravisCIã®å‹§ã‚ã‚‹CodeClimateã«çµ±åˆã—ã¦ã¿ã‚‹ã“ã¨ã¨ã—ãŸã€‚</p>

<h2 id="æ‰‹é †">æ‰‹é †</h2>

<h3 id="set-code-climate-token">Set Code Climate token</h3>

<p>CodeClimateã®Settingsã‹ã‚‰ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã®TokenãŒã‚²ãƒƒãƒˆã§ãã‚‹ã®ã§ãã‚Œã‚’<code class="language-plaintext highlighter-rouge">.travis.yml</code>ã«ã‚»ãƒƒãƒˆã€‚</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">addons</span><span class="pi">:</span>
  <span class="na">code_climate</span><span class="pi">:</span>
    <span class="na">repo_token</span><span class="pi">:</span> <span class="s">adf08323...</span>
</code></pre></div></div>

<h3 id="intall-codeclimate-reporter">Intall CodeClimate reporter</h3>

<p>codeclimate-test-reporter ã‚’<code class="language-plaintext highlighter-rouge">Gemfile</code>ã®test groupã«è¿½åŠ ã™ã‚‹ã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gem</span> <span class="s2">"codeclimate-test-reporter"</span><span class="p">,</span> <span class="ss">require: </span><span class="kp">false</span>
</code></pre></div></div>

<p>CodeClimateã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¤ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³é€šã‚Šã«æ›¸ãã¨ã“ã†ã€‚<code class="language-plaintext highlighter-rouge">spec/rails_helper.rb</code>ã«æ›¸ãã¾ã™ã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s2">"codeclimate-test-reporter"</span>
<span class="no">CodeClimate</span><span class="o">::</span><span class="no">TestReporter</span><span class="p">.</span><span class="nf">start</span>
</code></pre></div></div>

<h3 id="simplecovã¨åŒå±…ã•ã›ã‚‹">Simplecovã¨åŒå±…ã•ã›ã‚‹</h3>

<p>ç§ã®ç’°å¢ƒã®å ´åˆã€æ—¢ã«SimplecovãŒå…¥ã£ã¦ãŠã‚Šã¾ã—ãŸã®ã§ã€simplecovã¨ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã•ã›ã‚‹å ´åˆã¯ã¡ã‚‡ã£ã¨ç•°ãªã‚‹ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'simplecov'</span>
<span class="nb">require</span> <span class="s2">"codeclimate-test-reporter"</span>
<span class="no">SimpleCov</span><span class="p">.</span><span class="nf">formatter</span> <span class="o">=</span> <span class="no">SimpleCov</span><span class="o">::</span><span class="no">Formatter</span><span class="o">::</span><span class="no">MultiFormatter</span><span class="p">[</span>
  <span class="no">SimpleCov</span><span class="o">::</span><span class="no">Formatter</span><span class="o">::</span><span class="no">HTMLFormatter</span><span class="p">,</span>
  <span class="no">CodeClimate</span><span class="o">::</span><span class="no">TestReporter</span><span class="o">::</span><span class="no">Formatter</span>
<span class="p">]</span>
<span class="no">SimpleCov</span><span class="p">.</span><span class="nf">start</span> <span class="s2">"rails"</span>
</code></pre></div></div>

<p>ã“ã®ã‚ˆã†ã«SimpleCovã®formatterã«<code class="language-plaintext highlighter-rouge">CodeClimate::TestReporter::Formatter</code>ã‚’å…¥ã‚Œã¦ã‚„ã‚Œã° :ok:</p>

<p><img src="https://cloud.githubusercontent.com/assets/803398/6694285/ad01584c-cd1c-11e4-9f29-1589821188da.png" alt="codeclimate" /></p>

<p>ã“ã‚Œã§Code Climateä¸Šã§å“è³ªãƒ»ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ãŒé–²è¦§ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<ul>
  <li><a href="https://coderwall.com/p/vwhuqq/using-code-climate-s-new-test-reporter-together-with-coveralls-and-simplecov-s-html-formatter">Using Code Climateâ€™s new test reporter together with Coveralls and SimpleCovâ€™s HTML Formatter</a></li>
</ul>]]></content><author><name>Toshimaru</name></author><category term="rspec" /><category term="ci" /><summary type="html"><![CDATA[è¶£å‘³ã§ç«‹ã¡ä¸Šã’ã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã“ã®åº¦ã€Coverallsã‹ã‚‰CodeClimateã«ä¹—ã‚Šæ›ãˆã¦ã¿ãŸã®ã§ã€ãã®çŸ¥è¦‹ã®å…±æœ‰ã€‚è‡ªåˆ†ãŒRails(ruby)ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Githubã«å…¬é–‹ã™ã‚‹ã¨ãã€å¿…ãšä½¿ã†SaaSç¾¤ãŒã‚ã£ã¦ã€ä¾‹ãˆã°CIã‚µãƒ¼ãƒ“ã‚¹ã§ã‚ã£ãŸã‚Šã‚«ãƒãƒ¬ãƒƒã‚¸ç‡ã®è¨ˆæ¸¬ã§ã‚ã£ãŸã‚Šã‚³ãƒ¼ãƒ‰ã®å“è³ªã®è¨ˆæ¸¬ã§ã‚ã£ãŸã‚Šã™ã‚‹ã€‚]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://cloud.githubusercontent.com/assets/803398/6655997/d4f38dc4-cb5b-11e4-8663-86fad6baf1f3.png" /><media:content medium="image" url="https://cloud.githubusercontent.com/assets/803398/6655997/d4f38dc4-cb5b-11e4-8663-86fad6baf1f3.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">RSpecãŒé€šã£ãŸã‚Šè½ã¡ãŸã‚Šã—ãŸã¨ãã«ã¯seedå€¤ã‚’æŒ‡å®šã™ã‚‹</title><link href="https://blog.toshimaru.net/rspec-occasional-fail/" rel="alternate" type="text/html" title="RSpecãŒé€šã£ãŸã‚Šè½ã¡ãŸã‚Šã—ãŸã¨ãã«ã¯seedå€¤ã‚’æŒ‡å®šã™ã‚‹" /><published>2014-09-23T00:00:00+09:00</published><updated>2014-09-23T00:00:00+09:00</updated><id>https://blog.toshimaru.net/rspec-occasional-fail</id><content type="html" xml:base="https://blog.toshimaru.net/rspec-occasional-fail/"><![CDATA[<p>RSpecãŒãŸã¾ã«è½ã¡ãŸã‚Šé€šã£ãŸã‚Šã™ã‚‹ã€‚ãã‚“ãªã¨ãã¯RSpecã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †åºã«ã‚ˆã‚Šãƒ†ã‚¹ãƒˆãŒFailã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã€‚ã¤ã¾ã‚Šã‚ã‚‹ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œå¾Œã˜ã‚ƒãªã„ã¨é€šã‚‰ãªã„ã€ã¿ãŸã„ãªçŠ¶æ³ã«é™¥ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ã“ã‚Œã¯é †ç•ªã«ä¾å­˜ã—ãŸãƒ†ã‚¹ãƒˆãªã®ã§ã‚ˆã‚ã—ããªã„çŠ¶æ…‹ã§ã‚ã‚‹ã€‚</p>

<h2 id="ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±">ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±</h2>

<ul>
  <li>rails (4.1.5)</li>
  <li>rspec (3.1.0)</li>
</ul>

<h2 id="random-order-rspec">Random order RSpec</h2>

<p>RSpecã‚’é †ç•ªã«ä¾å­˜ã•ã›ãªã„ãŸã‚ã«<code class="language-plaintext highlighter-rouge">spec_helper.rb</code>ã§ã“ã‚“ãªè¨­å®šãŒã•ã‚Œã¦ã„ã‚‹ã€‚</p>

<div class="language-rb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Run specs in random order to surface order dependencies. If you find an</span>
<span class="c1"># order dependency and want to debug it, you can fix the order by providing</span>
<span class="c1"># the seed, which is printed after each run.</span>
<span class="c1">#     --seed 1234</span>
<span class="n">config</span><span class="p">.</span><span class="nf">order</span> <span class="o">=</span> <span class="s2">"random"</span>
</code></pre></div></div>

<p>ã“ã®è¨­å®šã«ã‚ˆã‚Šãƒ†ã‚¹ãƒˆå®Ÿè¡Œã®é †åºãŒãƒ©ãƒ³ãƒ€ãƒ ã«ãªã‚Šã€é †åºã«ä¾å­˜ã—ãªã„ãƒ†ã‚¹ãƒˆã®è¨˜è¿°ãŒå¯èƒ½ã¨ãªã‚‹ã€‚ã‚·ãƒ¼ãƒ‰å€¤ã¯ãƒ†ã‚¹ãƒˆã®æœ€å¾Œã«å¾—ã‚‰ã‚Œã‚‹ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Randomized with seed 724
</code></pre></div></div>

<h2 id="ã‚·ãƒ¼ãƒ‰å€¤ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œ">ã‚·ãƒ¼ãƒ‰å€¤ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œ</h2>

<p>Failã—ãŸãƒ†ã‚¹ãƒˆã®ã“ã®ã‚·ãƒ¼ãƒ‰å€¤ã‚’è¨­å®šã—ã¦ãƒ†ã‚¹ãƒˆã‚’èµ°ã‚‰ã›ã‚Œã°Failã—ãŸãƒ†ã‚¹ãƒˆã®é †ç•ªã‚’å†ç¾ã§ãã‚‹ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ bundle exec rspec --seed 724 --fail-fast
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">--seed</code>ã§ã‚·ãƒ¼ãƒ‰å€¤ã‚’æŒ‡å®šã€<code class="language-plaintext highlighter-rouge">--fail-fast</code>ã‚’è¨­å®šã—ã¦Failã—ãŸã¨ãã«ãƒ†ã‚¹ãƒˆã‚’å³æ™‚çµ‚äº†ã•ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚</p>

<p>ã“ã†ã™ã‚Œã°Failã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’å†ç¾ã§ãã¦ã€ã©ã®ãƒ†ã‚¹ãƒˆãŒã©ã“ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †ç•ªã«ä¾å­˜ã—ã¦è½ã¡ã¦ã„ã‚‹ã®ã‹ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>

<h2 id="å‚è€ƒ">å‚è€ƒ</h2>

<p><a href="http://ikm.hatenablog.jp/entry/2013/03/26/003838">ãƒ©ãƒ³ãƒ€ãƒ ã«è½ã¡ã‚‹specã®ä¿®æ­£ã§ä¾¿åˆ©ã ã£ãŸRSpecã®2ã¤ã®è¨­å®š</a></p>]]></content><author><name>Toshimaru</name></author><category term="rspec" /><summary type="html"><![CDATA[RSpecãŒãŸã¾ã«è½ã¡ãŸã‚Šé€šã£ãŸã‚Šã™ã‚‹ã€‚ãã‚“ãªã¨ãã¯RSpecã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé †åºã«ã‚ˆã‚Šãƒ†ã‚¹ãƒˆãŒFailã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã€‚ã¤ã¾ã‚Šã‚ã‚‹ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œå¾Œã˜ã‚ƒãªã„ã¨é€šã‚‰ãªã„ã€ã¿ãŸã„ãªçŠ¶æ³ã«é™¥ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ã“ã‚Œã¯é †ç•ªã«ä¾å­˜ã—ãŸãƒ†ã‚¹ãƒˆãªã®ã§ã‚ˆã‚ã—ããªã„çŠ¶æ…‹ã§ã‚ã‚‹ã€‚]]></summary></entry><entry><title type="html">RSpec2ã‹ã‚‰RSpec3ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸Šã’ãŸã‚‰ãƒ†ã‚¹ãƒˆãŒFailã—ã¾ãã£ãŸè©±</title><link href="https://blog.toshimaru.net/rspec2-to-rspec3-errors/" rel="alternate" type="text/html" title="RSpec2ã‹ã‚‰RSpec3ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸Šã’ãŸã‚‰ãƒ†ã‚¹ãƒˆãŒFailã—ã¾ãã£ãŸè©±" /><published>2014-07-19T00:00:00+09:00</published><updated>2014-07-19T00:00:00+09:00</updated><id>https://blog.toshimaru.net/rspec2-to-rspec3-errors</id><content type="html" xml:base="https://blog.toshimaru.net/rspec2-to-rspec3-errors/"><![CDATA[<p>éŠã³ã§ä½œã£ã¦ã‚‹Railsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®RSpecã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ï¼’ã‹ã‚‰ï¼“ã«ä¸Šã’ãŸã‚‰ã€ï¼’ã§ã¯å…¨éƒ¨é€šã£ã¦ãŸãƒ†ã‚¹ãƒˆãŒï¼“ã«ã—ãŸé€”ç«¯ãƒ†ã‚¹ãƒˆãŒ100å€‹ãã‚‰ã„Failã—ãŸã€‚ä¸€ä½“ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹ã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§RSpec3ã®æŒ™å‹•ã®é•ã„ã‚’èª¿ã¹ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚</p>

<p><code class="language-plaintext highlighter-rouge">rspec-rails</code>ã‚’<code class="language-plaintext highlighter-rouge">bundle install</code>ã—ãŸã‚ã¨<code class="language-plaintext highlighter-rouge">rspec:install</code>ã™ã‚‹ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ rails g rspec:install
create  .rspec
create  spec
create  spec/spec_helper.rb
create  spec/rails_helper.rb
</code></pre></div></div>

<p>ä»Šã¾ã§ãªã‹ã£ãŸ<code class="language-plaintext highlighter-rouge">rails_helper.rb</code>ã£ã¦ã®ãŒä½œã‚‰ã‚Œã¦ã„ã‚‹ã€‚<code class="language-plaintext highlighter-rouge">scaffold</code>ã§ç”Ÿæˆã•ã‚Œã‚‹specãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ§‹æˆã¯ã“ã†ã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>spec
â”œâ”€â”€ controllers
â”‚Â Â  â””â”€â”€ users_controller_spec.rb
â”œâ”€â”€ helpers
â”‚Â Â  â””â”€â”€ users_helper_spec.rb
â”œâ”€â”€ models
â”‚Â Â  â””â”€â”€ user_spec.rb
â”œâ”€â”€ rails_helper.rb
â”œâ”€â”€ requests
â”‚Â Â  â””â”€â”€ users_spec.rb
â”œâ”€â”€ routing
â”‚Â Â  â””â”€â”€ users_routing_spec.rb
â”œâ”€â”€ spec_helper.rb
â””â”€â”€ views
    â””â”€â”€ users
        â”œâ”€â”€ edit.html.erb_spec.rb
        â”œâ”€â”€ index.html.erb_spec.rb
        â”œâ”€â”€ new.html.erb_spec.rb
        â””â”€â”€ show.html.erb_spec.rb
</code></pre></div></div>

<p>è©¦ã—ã«<code class="language-plaintext highlighter-rouge">spec/controllers/users_controller_spec.rb</code>ã‚’é–‹ã„ã¦ã¿ã‚‹ã¨å†’é ­ãŒã“ã‚“ãªæ„Ÿã˜ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>require 'rails_helper'
</code></pre></div></div>

<p><a href="http://willnet.in/126">RSpec 3 æ™‚ä»£ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ« rails_helper.rb ã«ã¤ã„ã¦</a></p>

<blockquote>
  <p>ã¨ã„ã†ã‚ã‘ã§ã€ã“ã‚Œã¾ã§ require â€˜spec_helperâ€™ ã¨ã—ã¦ã„ãŸç®‡æ‰€ã®å¤§éƒ¨åˆ†ã¯ require â€˜rails_helperâ€™ ã«ç½®æ›ã—ã¦ã‚ã’ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã­ã€‚ãƒ‘ãƒ¼ãƒ•ã‚§ã‚¯ãƒˆ Ruby on Rails ã®ãƒ†ã‚¹ãƒˆã®ç« ã¯ require â€˜spec_helperâ€™ ã¨ãªã£ã¦ã„ã‚‹ã®ã§ã€RSpec 3 ã®ãƒªãƒªãƒ¼ã‚¹ç‰ˆã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯é©å®œèª­ã¿æ›¿ãˆã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚</p>
</blockquote>

<p><code class="language-plaintext highlighter-rouge">spec_helper</code>ã‚’<code class="language-plaintext highlighter-rouge">rails_helper</code>ã«å¤‰ãˆã¦ã€ãã‚Œã‚‰ã®ï¼’ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã‚’RSpec3ç”¨ã«è¦‹ç›´ã›ã°å…¨ã¦ã®ãƒ†ã‚¹ãƒˆãŒå•é¡Œãªãé€šã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€ã¨ã•ã€‚</p>

<p>RSpec3ã‚ˆã‚Šruby1.8,ruby1.9ã‚’ã‚µãƒãƒ¼ãƒˆã—ãªããªã£ãŸã‚Šæ–°ã—ã„ãƒãƒƒãƒãƒ£ãƒ¼ãŒå¢—ãˆãŸã‚Šã—ã¦ã‚‹ã®ã§å¤‰æ›´ç‚¹ã‚’ä¸‹è¨˜ã‚ˆã‚Šå†åº¦ç¢ºèªã—ã¦ã¿ã‚‹ã¨ã‚ˆã„ã¨æ€ã„ã¾ã™ã€‚</p>

<p><a href="http://myronmars.to/n/dev-blog/2014/05/notable-changes-in-rspec-3">Notable Changes in RSpec 3</a></p>]]></content><author><name>Toshimaru</name></author><category term="ruby" /><category term="rspec" /><summary type="html"><![CDATA[éŠã³ã§ä½œã£ã¦ã‚‹Railsã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®RSpecã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ï¼’ã‹ã‚‰ï¼“ã«ä¸Šã’ãŸã‚‰ã€ï¼’ã§ã¯å…¨éƒ¨é€šã£ã¦ãŸãƒ†ã‚¹ãƒˆãŒï¼“ã«ã—ãŸé€”ç«¯ãƒ†ã‚¹ãƒˆãŒ100å€‹ãã‚‰ã„Failã—ãŸã€‚ä¸€ä½“ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹ã‚ã‹ã‚‰ãªã‹ã£ãŸã®ã§RSpec3ã®æŒ™å‹•ã®é•ã„ã‚’èª¿ã¹ã¦ã¿ã‚‹ã“ã¨ã«ã—ãŸã€‚]]></summary></entry></feed>